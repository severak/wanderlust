var wanderlust=(()=>{var Ci=Object.create;var Se=Object.defineProperty;var Di=Object.getOwnPropertyDescriptor;var Pi=Object.getOwnPropertyNames;var Vi=Object.getPrototypeOf,Xi=Object.prototype.hasOwnProperty;var te=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Yi=(e,t)=>{for(var i in t)Se(e,i,{get:t[i],enumerable:!0})},_t=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Pi(t))!Xi.call(e,n)&&n!==i&&Se(e,n,{get:()=>t[n],enumerable:!(r=Di(t,n))||r.enumerable});return e};var ae=(e,t,i)=>(i=e!=null?Ci(Vi(e)):{},_t(t||!e||!e.__esModule?Se(i,"default",{value:e,enumerable:!0}):i,e)),Ai=e=>_t(Se({},"__esModule",{value:!0}),e);var ke=te((ms,ui)=>{"use strict";ui.exports=fe;function fe(e,t){this.x=e,this.y=t}fe.prototype={clone:function(){return new fe(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,i=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=i,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),r=t*this.x-i*this.y,n=i*this.x+t*this.y;return this.x=r,this.y=n,this},_rotateAround:function(e,t){var i=Math.cos(e),r=Math.sin(e),n=t.x+i*(this.x-t.x)-r*(this.y-t.y),s=t.y+r*(this.x-t.x)+i*(this.y-t.y);return this.x=n,this.y=s,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};fe.convert=function(e){return e instanceof fe?e:Array.isArray(e)?new fe(e[0],e[1]):e}});var di=te((dt,ct)=>{(function(e,t){typeof dt=="object"&&typeof ct!="undefined"?ct.exports=t():typeof define=="function"&&define.amd?define(t):(e=e||self).RBush=t()})(dt,function(){"use strict";function e(m,y,f,c,p){(function w(b,z,k,B,T){for(;B>k;){if(B-k>600){var C=B-k+1,X=z-k+1,V=Math.log(C),h=.5*Math.exp(2*V/3),g=.5*Math.sqrt(V*h*(C-h)/C)*(X-C/2<0?-1:1),M=Math.max(k,Math.floor(z-X*h/C+g)),P=Math.min(B,Math.floor(z+(C-X)*h/C+g));w(b,z,M,P,T)}var D=b[z],Y=k,A=B;for(t(b,k,z),T(b[B],D)>0&&t(b,k,B);Y<A;){for(t(b,Y,A),Y++,A--;T(b[Y],D)<0;)Y++;for(;T(b[A],D)>0;)A--}T(b[k],D)===0?t(b,k,A):t(b,++A,B),A<=z&&(k=A+1),z<=A&&(B=A-1)}})(m,y,f||0,c||m.length-1,p||i)}function t(m,y,f){var c=m[y];m[y]=m[f],m[f]=c}function i(m,y){return m<y?-1:m>y?1:0}var r=function(m){m===void 0&&(m=9),this._maxEntries=Math.max(4,m),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function n(m,y,f){if(!f)return y.indexOf(m);for(var c=0;c<y.length;c++)if(f(m,y[c]))return c;return-1}function s(m,y){a(m,0,m.children.length,y,m)}function a(m,y,f,c,p){p||(p=F(null)),p.minX=1/0,p.minY=1/0,p.maxX=-1/0,p.maxY=-1/0;for(var w=y;w<f;w++){var b=m.children[w];o(p,m.leaf?c(b):b)}return p}function o(m,y){return m.minX=Math.min(m.minX,y.minX),m.minY=Math.min(m.minY,y.minY),m.maxX=Math.max(m.maxX,y.maxX),m.maxY=Math.max(m.maxY,y.maxY),m}function l(m,y){return m.minX-y.minX}function u(m,y){return m.minY-y.minY}function d(m){return(m.maxX-m.minX)*(m.maxY-m.minY)}function x(m){return m.maxX-m.minX+(m.maxY-m.minY)}function v(m,y){return m.minX<=y.minX&&m.minY<=y.minY&&y.maxX<=m.maxX&&y.maxY<=m.maxY}function _(m,y){return y.minX<=m.maxX&&y.minY<=m.maxY&&y.maxX>=m.minX&&y.maxY>=m.minY}function F(m){return{children:m,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function S(m,y,f,c,p){for(var w=[y,f];w.length;)if(!((f=w.pop())-(y=w.pop())<=c)){var b=y+Math.ceil((f-y)/c/2)*c;e(m,b,y,f,p),w.push(y,b,b,f)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(m){var y=this.data,f=[];if(!_(m,y))return f;for(var c=this.toBBox,p=[];y;){for(var w=0;w<y.children.length;w++){var b=y.children[w],z=y.leaf?c(b):b;_(m,z)&&(y.leaf?f.push(b):v(m,z)?this._all(b,f):p.push(b))}y=p.pop()}return f},r.prototype.collides=function(m){var y=this.data;if(!_(m,y))return!1;for(var f=[];y;){for(var c=0;c<y.children.length;c++){var p=y.children[c],w=y.leaf?this.toBBox(p):p;if(_(m,w)){if(y.leaf||v(m,w))return!0;f.push(p)}}y=f.pop()}return!1},r.prototype.load=function(m){if(!m||!m.length)return this;if(m.length<this._minEntries){for(var y=0;y<m.length;y++)this.insert(m[y]);return this}var f=this._build(m.slice(),0,m.length-1,0);if(this.data.children.length)if(this.data.height===f.height)this._splitRoot(this.data,f);else{if(this.data.height<f.height){var c=this.data;this.data=f,f=c}this._insert(f,this.data.height-f.height-1,!0)}else this.data=f;return this},r.prototype.insert=function(m){return m&&this._insert(m,this.data.height-1),this},r.prototype.clear=function(){return this.data=F([]),this},r.prototype.remove=function(m,y){if(!m)return this;for(var f,c,p,w=this.data,b=this.toBBox(m),z=[],k=[];w||z.length;){if(w||(w=z.pop(),c=z[z.length-1],f=k.pop(),p=!0),w.leaf){var B=n(m,w.children,y);if(B!==-1)return w.children.splice(B,1),z.push(w),this._condense(z),this}p||w.leaf||!v(w,b)?c?(f++,w=c.children[f],p=!1):w=null:(z.push(w),k.push(f),f=0,c=w,w=w.children[0])}return this},r.prototype.toBBox=function(m){return m},r.prototype.compareMinX=function(m,y){return m.minX-y.minX},r.prototype.compareMinY=function(m,y){return m.minY-y.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(m){return this.data=m,this},r.prototype._all=function(m,y){for(var f=[];m;)m.leaf?y.push.apply(y,m.children):f.push.apply(f,m.children),m=f.pop();return y},r.prototype._build=function(m,y,f,c){var p,w=f-y+1,b=this._maxEntries;if(w<=b)return s(p=F(m.slice(y,f+1)),this.toBBox),p;c||(c=Math.ceil(Math.log(w)/Math.log(b)),b=Math.ceil(w/Math.pow(b,c-1))),(p=F([])).leaf=!1,p.height=c;var z=Math.ceil(w/b),k=z*Math.ceil(Math.sqrt(b));S(m,y,f,k,this.compareMinX);for(var B=y;B<=f;B+=k){var T=Math.min(B+k-1,f);S(m,B,T,z,this.compareMinY);for(var C=B;C<=T;C+=z){var X=Math.min(C+z-1,T);p.children.push(this._build(m,C,X,c-1))}}return s(p,this.toBBox),p},r.prototype._chooseSubtree=function(m,y,f,c){for(;c.push(y),!y.leaf&&c.length-1!==f;){for(var p=1/0,w=1/0,b=void 0,z=0;z<y.children.length;z++){var k=y.children[z],B=d(k),T=(C=m,X=k,(Math.max(X.maxX,C.maxX)-Math.min(X.minX,C.minX))*(Math.max(X.maxY,C.maxY)-Math.min(X.minY,C.minY))-B);T<w?(w=T,p=B<p?B:p,b=k):T===w&&B<p&&(p=B,b=k)}y=b||y.children[0]}var C,X;return y},r.prototype._insert=function(m,y,f){var c=f?m:this.toBBox(m),p=[],w=this._chooseSubtree(c,this.data,y,p);for(w.children.push(m),o(w,c);y>=0&&p[y].children.length>this._maxEntries;)this._split(p,y),y--;this._adjustParentBBoxes(c,p,y)},r.prototype._split=function(m,y){var f=m[y],c=f.children.length,p=this._minEntries;this._chooseSplitAxis(f,p,c);var w=this._chooseSplitIndex(f,p,c),b=F(f.children.splice(w,f.children.length-w));b.height=f.height,b.leaf=f.leaf,s(f,this.toBBox),s(b,this.toBBox),y?m[y-1].children.push(b):this._splitRoot(f,b)},r.prototype._splitRoot=function(m,y){this.data=F([m,y]),this.data.height=m.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(m,y,f){for(var c,p,w,b,z,k,B,T=1/0,C=1/0,X=y;X<=f-y;X++){var V=a(m,0,X,this.toBBox),h=a(m,X,f,this.toBBox),g=(p=V,w=h,b=void 0,z=void 0,k=void 0,B=void 0,b=Math.max(p.minX,w.minX),z=Math.max(p.minY,w.minY),k=Math.min(p.maxX,w.maxX),B=Math.min(p.maxY,w.maxY),Math.max(0,k-b)*Math.max(0,B-z)),M=d(V)+d(h);g<T?(T=g,c=X,C=M<C?M:C):g===T&&M<C&&(C=M,c=X)}return c||f-y},r.prototype._chooseSplitAxis=function(m,y,f){var c=m.leaf?this.compareMinX:l,p=m.leaf?this.compareMinY:u;this._allDistMargin(m,y,f,c)<this._allDistMargin(m,y,f,p)&&m.children.sort(c)},r.prototype._allDistMargin=function(m,y,f,c){m.children.sort(c);for(var p=this.toBBox,w=a(m,0,y,p),b=a(m,f-y,f,p),z=x(w)+x(b),k=y;k<f-y;k++){var B=m.children[k];o(w,m.leaf?p(B):B),z+=x(w)}for(var T=f-y-1;T>=y;T--){var C=m.children[T];o(b,m.leaf?p(C):C),z+=x(b)}return z},r.prototype._adjustParentBBoxes=function(m,y,f){for(var c=f;c>=0;c--)o(y[c],m)},r.prototype._condense=function(m){for(var y=m.length-1,f=void 0;y>=0;y--)m[y].children.length===0?y>0?(f=m[y-1].children).splice(f.indexOf(m[y]),1):this.clear():s(m[y],this.toBBox)},r})});var pt=te((xs,ci)=>{"use strict";var Kr=ke();ci.exports=ue;function ue(e,t,i,r,n){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=r,this._values=n,e.readFields(Gr,this,t)}function Gr(e,t,i){e==1?t.id=i.readVarint():e==2?Qr(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function Qr(e,t){for(var i=e.readVarint()+e.pos;e.pos<i;){var r=t._keys[e.readVarint()],n=t._values[e.readVarint()];t.properties[r]=n}}ue.types=["Unknown","Point","LineString","Polygon"];ue.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,r=0,n=0,s=0,a=[],o;e.pos<t;){if(r<=0){var l=e.readVarint();i=l&7,r=l>>3}if(r--,i===1||i===2)n+=e.readSVarint(),s+=e.readSVarint(),i===1&&(o&&a.push(o),o=[]),o.push(new Kr(n,s));else if(i===7)o&&o.push(o[0].clone());else throw new Error("unknown command "+i)}return o&&a.push(o),a};ue.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,r=0,n=0,s=0,a=1/0,o=-1/0,l=1/0,u=-1/0;e.pos<t;){if(r<=0){var d=e.readVarint();i=d&7,r=d>>3}if(r--,i===1||i===2)n+=e.readSVarint(),s+=e.readSVarint(),n<a&&(a=n),n>o&&(o=n),s<l&&(l=s),s>u&&(u=s);else if(i!==7)throw new Error("unknown command "+i)}return[a,l,o,u]};ue.prototype.toGeoJSON=function(e,t,i){var r=this.extent*Math.pow(2,i),n=this.extent*e,s=this.extent*t,a=this.loadGeometry(),o=ue.types[this.type],l,u;function d(_){for(var F=0;F<_.length;F++){var S=_[F],m=180-(S.y+s)*360/r;_[F]=[(S.x+n)*360/r-180,360/Math.PI*Math.atan(Math.exp(m*Math.PI/180))-90]}}switch(this.type){case 1:var x=[];for(l=0;l<a.length;l++)x[l]=a[l][0];a=x,d(a);break;case 2:for(l=0;l<a.length;l++)d(a[l]);break;case 3:for(a=en(a),l=0;l<a.length;l++)for(u=0;u<a[l].length;u++)d(a[l][u]);break}a.length===1?a=a[0]:o="Multi"+o;var v={type:"Feature",geometry:{type:o,coordinates:a},properties:this.properties};return"id"in this&&(v.id=this.id),v};function en(e){var t=e.length;if(t<=1)return[e];for(var i=[],r,n,s=0;s<t;s++){var a=tn(e[s]);a!==0&&(n===void 0&&(n=a<0),n===a<0?(r&&i.push(r),r=[e[s]]):r.push(e[s]))}return r&&i.push(r),i}function tn(e){for(var t=0,i=0,r=e.length,n=r-1,s,a;i<r;n=i++)s=e[i],a=e[n],t+=(a.x-s.x)*(s.y+a.y);return t}});var mt=te((ys,mi)=>{"use strict";var rn=pt();mi.exports=pi;function pi(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(nn,this,t),this.length=this._features.length}function nn(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(sn(i))}function sn(e){for(var t=null,i=e.readVarint()+e.pos;e.pos<i;){var r=e.readVarint()>>3;t=r===1?e.readString():r===2?e.readFloat():r===3?e.readDouble():r===4?e.readVarint64():r===5?e.readVarint():r===6?e.readSVarint():r===7?e.readBoolean():null}return t}pi.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new rn(this._pbf,t,this.extent,this._keys,this._values)}});var yi=te((gs,xi)=>{"use strict";var an=mt();xi.exports=on;function on(e,t){this.layers=e.readFields(ln,{},t)}function ln(e,t,i){if(e===3){var r=new an(i,i.readVarint()+i.pos);r.length&&(t[r.name]=r)}}});var gi=te((ws,Ee)=>{Ee.exports.VectorTile=yi();Ee.exports.VectorTileFeature=pt();Ee.exports.VectorTileLayer=mt()});var wi=te(xt=>{xt.read=function(e,t,i,r,n){var s,a,o=n*8-r-1,l=(1<<o)-1,u=l>>1,d=-7,x=i?n-1:0,v=i?-1:1,_=e[t+x];for(x+=v,s=_&(1<<-d)-1,_>>=-d,d+=o;d>0;s=s*256+e[t+x],x+=v,d-=8);for(a=s&(1<<-d)-1,s>>=-d,d+=r;d>0;a=a*256+e[t+x],x+=v,d-=8);if(s===0)s=1-u;else{if(s===l)return a?NaN:(_?-1:1)*(1/0);a=a+Math.pow(2,r),s=s-u}return(_?-1:1)*a*Math.pow(2,s-r)};xt.write=function(e,t,i,r,n,s){var a,o,l,u=s*8-n-1,d=(1<<u)-1,x=d>>1,v=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,_=r?0:s-1,F=r?1:-1,S=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=d):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+x>=1?t+=v/l:t+=v*Math.pow(2,1-x),t*l>=2&&(a++,l/=2),a+x>=d?(o=0,a=d):a+x>=1?(o=(t*l-1)*Math.pow(2,n),a=a+x):(o=t*Math.pow(2,x-1)*Math.pow(2,n),a=0));n>=8;e[i+_]=o&255,_+=F,o/=256,n-=8);for(a=a<<n|o,u+=n;u>0;e[i+_]=a&255,_+=F,a/=256,u-=8);e[i+_-F]|=S*128}});var Fi=te((_s,zi)=>{"use strict";zi.exports=I;var Re=wi();function I(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}I.Varint=0;I.Fixed64=1;I.Bytes=2;I.Fixed32=5;var yt=(1<<16)*(1<<16),vi=1/yt,hn=12,Mi=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");I.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),n=r>>3,s=this.pos;this.type=r&7,e(n,t,this),this.pos===s&&this.skip(r)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Oe(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=bi(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Oe(this.buf,this.pos)+Oe(this.buf,this.pos+4)*yt;return this.pos+=8,e},readSFixed64:function(){var e=Oe(this.buf,this.pos)+bi(this.buf,this.pos+4)*yt;return this.pos+=8,e},readFloat:function(){var e=Re.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Re.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t=this.buf,i,r;return r=t[this.pos++],i=r&127,r<128||(r=t[this.pos++],i|=(r&127)<<7,r<128)||(r=t[this.pos++],i|=(r&127)<<14,r<128)||(r=t[this.pos++],i|=(r&127)<<21,r<128)?i:(r=t[this.pos],i|=(r&15)<<28,fn(i,e,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=hn&&Mi?zn(this.buf,t,e):Mn(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==I.Bytes)return e.push(this.readVarint(t));var i=ee(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==I.Bytes)return e.push(this.readSVarint());var t=ee(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==I.Bytes)return e.push(this.readBoolean());var t=ee(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==I.Bytes)return e.push(this.readFloat());var t=ee(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==I.Bytes)return e.push(this.readDouble());var t=ee(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==I.Bytes)return e.push(this.readFixed32());var t=ee(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==I.Bytes)return e.push(this.readSFixed32());var t=ee(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==I.Bytes)return e.push(this.readFixed64());var t=ee(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==I.Bytes)return e.push(this.readSFixed64());var t=ee(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=e&7;if(t===I.Varint)for(;this.buf[this.pos++]>127;);else if(t===I.Bytes)this.pos=this.readVarint()+this.pos;else if(t===I.Fixed32)this.pos+=4;else if(t===I.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+t)},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),ce(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),ce(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),ce(this.buf,e&-1,this.pos),ce(this.buf,Math.floor(e*vi),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),ce(this.buf,e&-1,this.pos),ce(this.buf,Math.floor(e*vi),this.pos+4),this.pos+=8},writeVarint:function(e){if(e=+e||0,e>268435455||e<0){un(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))},writeSVarint:function(e){this.writeVarint(e<0?-e*2-1:e*2)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(e.length*4),this.pos++;var t=this.pos;this.pos=Fn(this.buf,e,this.pos);var i=this.pos-t;i>=128&&_i(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),Re.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Re.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var r=this.pos-i;r>=128&&_i(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeMessage:function(e,t,i){this.writeTag(e,I.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,pn,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,mn,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,gn,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,xn,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,yn,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,wn,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,vn,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,_n,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,bn,t)},writeBytesField:function(e,t){this.writeTag(e,I.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,I.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,I.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,I.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,I.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,I.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,I.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,I.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,I.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,I.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};function fn(e,t,i){var r=i.buf,n,s;if(s=r[i.pos++],n=(s&112)>>4,s<128||(s=r[i.pos++],n|=(s&127)<<3,s<128)||(s=r[i.pos++],n|=(s&127)<<10,s<128)||(s=r[i.pos++],n|=(s&127)<<17,s<128)||(s=r[i.pos++],n|=(s&127)<<24,s<128)||(s=r[i.pos++],n|=(s&1)<<31,s<128))return de(e,n,t);throw new Error("Expected varint not more than 10 bytes")}function ee(e){return e.type===I.Bytes?e.readVarint()+e.pos:e.pos+1}function de(e,t,i){return i?t*4294967296+(e>>>0):(t>>>0)*4294967296+(e>>>0)}function un(e,t){var i,r;if(e>=0?(i=e%4294967296|0,r=e/4294967296|0):(i=~(-e%4294967296),r=~(-e/4294967296),i^4294967295?i=i+1|0:(i=0,r=r+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),dn(i,r,t),cn(r,t)}function dn(e,t,i){i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos++]=e&127|128,e>>>=7,i.buf[i.pos]=e&127}function cn(e,t){var i=(e&7)<<4;t.buf[t.pos++]|=i|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127)))))}function _i(e,t,i){var r=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));i.realloc(r);for(var n=i.pos-1;n>=e;n--)i.buf[n+r]=i.buf[n]}function pn(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function mn(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function xn(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function yn(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function gn(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function wn(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function vn(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function _n(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function bn(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Oe(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+e[t+3]*16777216}function ce(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function bi(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Mn(e,t,i){for(var r="",n=t;n<i;){var s=e[n],a=null,o=s>239?4:s>223?3:s>191?2:1;if(n+o>i)break;var l,u,d;o===1?s<128&&(a=s):o===2?(l=e[n+1],(l&192)===128&&(a=(s&31)<<6|l&63,a<=127&&(a=null))):o===3?(l=e[n+1],u=e[n+2],(l&192)===128&&(u&192)===128&&(a=(s&15)<<12|(l&63)<<6|u&63,(a<=2047||a>=55296&&a<=57343)&&(a=null))):o===4&&(l=e[n+1],u=e[n+2],d=e[n+3],(l&192)===128&&(u&192)===128&&(d&192)===128&&(a=(s&15)<<18|(l&63)<<12|(u&63)<<6|d&63,(a<=65535||a>=1114112)&&(a=null))),a===null?(a=65533,o=1):a>65535&&(a-=65536,r+=String.fromCharCode(a>>>10&1023|55296),a=56320|a&1023),r+=String.fromCharCode(a),n+=o}return r}function zn(e,t,i){return Mi.decode(e.subarray(t,i))}function Fn(e,t,i){for(var r=0,n,s;r<t.length;r++){if(n=t.charCodeAt(r),n>55295&&n<57344)if(s)if(n<56320){e[i++]=239,e[i++]=191,e[i++]=189,s=n;continue}else n=s-55296<<10|n-56320|65536,s=null;else{n>56319||r+1===t.length?(e[i++]=239,e[i++]=191,e[i++]=189):s=n;continue}else s&&(e[i++]=239,e[i++]=191,e[i++]=189,s=null);n<128?e[i++]=n:(n<2048?e[i++]=n>>6|192:(n<65536?e[i++]=n>>12|224:(e[i++]=n>>18|240,e[i++]=n>>12&63|128),e[i++]=n>>6&63|128),e[i++]=n&63|128)}return i}});var Pn={};Yi(Pn,{CenteredSymbolizer:()=>ai,CenteredTextSymbolizer:()=>G,CircleSymbolizer:()=>ze,FlexSymbolizer:()=>Ge,Font:()=>Wr,GeomType:()=>ne,GroupSymbolizer:()=>Qe,IconSymbolizer:()=>Yr,Index:()=>Gt,Justify:()=>Je,Labeler:()=>lt,Labelers:()=>He,LineLabelPlacement:()=>et,LineLabelSymbolizer:()=>ut,LineSymbolizer:()=>q,OffsetSymbolizer:()=>oi,OffsetTextSymbolizer:()=>we,PMTiles:()=>qt,Padding:()=>Ar,PmtilesSource:()=>$e,PolygonLabelSymbolizer:()=>Ce,PolygonSymbolizer:()=>O,Sheet:()=>Hr,ShieldSymbolizer:()=>ni,Static:()=>Or,TextPlacements:()=>Ke,TextSymbolizer:()=>he,TileCache:()=>Ht,View:()=>Jt,ZxySource:()=>Ut,arr:()=>Dr,covering:()=>Kt,createPattern:()=>Cr,cubicBezier:()=>Xr,dark:()=>Ve,exp:()=>W,filterFn:()=>_e,getFont:()=>nt,getZoom:()=>tt,isCCW:()=>Nt,isInRing:()=>Ze,json_style:()=>Jr,labelRules:()=>Ye,leafletLayer:()=>Nr,light:()=>Pe,linear:()=>Vr,numberFn:()=>Ae,numberOrFn:()=>it,paintRules:()=>Xe,painter:()=>ot,pointInPolygon:()=>$t,pointMinDistToLines:()=>Zt,pointMinDistToPoints:()=>Wt,sourcesToViews:()=>at,step:()=>Pr,toIndex:()=>re,transformGeom:()=>st,vincent:()=>vt,widthFn:()=>rt,wrap:()=>ge});var $={};$.log=function(e,t){console.log(t.props)};$.municipality=function(e,t){return["city","town","village","hamlet"].includes(t.props.place)};$.stateBorders=function(e,t){return t.props["pmap:min_admin_level"]==2};$.waterways=function(e,t){return t.props.waterway=="river"||e>15&&t.props.waterway=="stream"};$.wood=function(e,t){return t.props.natural=="wood"||t.props.landuse=="forest"};$.railway=function(e,t){return t.props.railway=="rail"};var Ii=Object.create,Ie=Object.defineProperty,Ei=Object.getOwnPropertyDescriptor,Ri=Object.getOwnPropertyNames,bt=Object.getOwnPropertySymbols,Oi=Object.getPrototypeOf,Xt=Object.prototype.hasOwnProperty,qi=Object.prototype.propertyIsEnumerable,Mt=(e,t,i)=>t in e?Ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ji=(e,t)=>{for(var i in t||(t={}))Xt.call(t,i)&&Mt(e,i,t[i]);if(bt)for(var i of bt(t))qi.call(t,i)&&Mt(e,i,t[i]);return e},Ui=e=>Ie(e,"__esModule",{value:!0}),K=(e,t)=>function(){return t||(0,e[Object.keys(e)[0]])((t={exports:{}}).exports,t),t.exports},Ni=(e,t,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Ri(t))!Xt.call(e,r)&&r!=="default"&&Ie(e,r,{get:()=>t[r],enumerable:!(i=Ei(t,r))||i.enumerable});return e},N=e=>Ni(Ui(Ie(e!=null?Ii(Oi(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),Z=(e,t,i)=>new Promise((r,n)=>{var s=l=>{try{o(i.next(l))}catch(u){n(u)}},a=l=>{try{o(i.throw(l))}catch(u){n(u)}},o=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,a);o((i=i.apply(e,t)).next())}),Q=K({"node_modules/@mapbox/point-geometry/index.js"(e,t){"use strict";t.exports=i;function i(r,n){this.x=r,this.y=n}i.prototype={clone:function(){return new i(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,n){return this.clone()._rotateAround(r,n)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var n=r.x-this.x,s=r.y-this.y;return n*n+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,n){return Math.atan2(this.x*n-this.y*r,this.x*r+this.y*n)},_matMult:function(r){var n=r[0]*this.x+r[1]*this.y,s=r[2]*this.x+r[3]*this.y;return this.x=n,this.y=s,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var n=Math.cos(r),s=Math.sin(r),a=n*this.x-s*this.y,o=s*this.x+n*this.y;return this.x=a,this.y=o,this},_rotateAround:function(r,n){var s=Math.cos(r),a=Math.sin(r),o=n.x+s*(this.x-n.x)-a*(this.y-n.y),l=n.y+a*(this.x-n.x)+s*(this.y-n.y);return this.x=o,this.y=l,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(r){return r instanceof i?r:Array.isArray(r)?new i(r[0],r[1]):r}}}),Yt=K({"node_modules/@mapbox/vector-tile/lib/vectortilefeature.js"(e,t){"use strict";var i=Q();t.exports=r;function r(l,u,d,x,v){this.properties={},this.extent=d,this.type=0,this._pbf=l,this._geometry=-1,this._keys=x,this._values=v,l.readFields(n,this,u)}function n(l,u,d){l==1?u.id=d.readVarint():l==2?s(d,u):l==3?u.type=d.readVarint():l==4&&(u._geometry=d.pos)}function s(l,u){for(var d=l.readVarint()+l.pos;l.pos<d;){var x=u._keys[l.readVarint()],v=u._values[l.readVarint()];u.properties[x]=v}}r.types=["Unknown","Point","LineString","Polygon"],r.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var u=l.readVarint()+l.pos,d=1,x=0,v=0,_=0,F=[],S;l.pos<u;){if(x<=0){var m=l.readVarint();d=m&7,x=m>>3}if(x--,d===1||d===2)v+=l.readSVarint(),_+=l.readSVarint(),d===1&&(S&&F.push(S),S=[]),S.push(new i(v,_));else if(d===7)S&&S.push(S[0].clone());else throw new Error("unknown command "+d)}return S&&F.push(S),F},r.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var u=l.readVarint()+l.pos,d=1,x=0,v=0,_=0,F=1/0,S=-1/0,m=1/0,y=-1/0;l.pos<u;){if(x<=0){var f=l.readVarint();d=f&7,x=f>>3}if(x--,d===1||d===2)v+=l.readSVarint(),_+=l.readSVarint(),v<F&&(F=v),v>S&&(S=v),_<m&&(m=_),_>y&&(y=_);else if(d!==7)throw new Error("unknown command "+d)}return[F,m,S,y]},r.prototype.toGeoJSON=function(l,u,d){var x=this.extent*Math.pow(2,d),v=this.extent*l,_=this.extent*u,F=this.loadGeometry(),S=r.types[this.type],m,y;function f(w){for(var b=0;b<w.length;b++){var z=w[b],k=180-(z.y+_)*360/x;w[b]=[(z.x+v)*360/x-180,360/Math.PI*Math.atan(Math.exp(k*Math.PI/180))-90]}}switch(this.type){case 1:var c=[];for(m=0;m<F.length;m++)c[m]=F[m][0];F=c,f(F);break;case 2:for(m=0;m<F.length;m++)f(F[m]);break;case 3:for(F=a(F),m=0;m<F.length;m++)for(y=0;y<F[m].length;y++)f(F[m][y]);break}F.length===1?F=F[0]:S="Multi"+S;var p={type:"Feature",geometry:{type:S,coordinates:F},properties:this.properties};return"id"in this&&(p.id=this.id),p};function a(l){var u=l.length;if(u<=1)return[l];for(var d=[],x,v,_=0;_<u;_++){var F=o(l[_]);F!==0&&(v===void 0&&(v=F<0),v===F<0?(x&&d.push(x),x=[l[_]]):x.push(l[_]))}return x&&d.push(x),d}function o(l){for(var u=0,d=0,x=l.length,v=x-1,_,F;d<x;v=d++)_=l[d],F=l[v],u+=(F.x-_.x)*(_.y+F.y);return u}}}),At=K({"node_modules/@mapbox/vector-tile/lib/vectortilelayer.js"(e,t){"use strict";var i=Yt();t.exports=r;function r(a,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(n,this,o),this.length=this._features.length}function n(a,o,l){a===15?o.version=l.readVarint():a===1?o.name=l.readString():a===5?o.extent=l.readVarint():a===2?o._features.push(l.pos):a===3?o._keys.push(l.readString()):a===4&&o._values.push(s(l))}function s(a){for(var o=null,l=a.readVarint()+a.pos;a.pos<l;){var u=a.readVarint()>>3;o=u===1?a.readString():u===2?a.readFloat():u===3?a.readDouble():u===4?a.readVarint64():u===5?a.readVarint():u===6?a.readSVarint():u===7?a.readBoolean():null}return o}r.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var o=this._pbf.readVarint()+this._pbf.pos;return new i(this._pbf,o,this.extent,this._keys,this._values)}}}),$i=K({"node_modules/@mapbox/vector-tile/lib/vectortile.js"(e,t){"use strict";var i=At();t.exports=r;function r(s,a){this.layers=s.readFields(n,{},a)}function n(s,a,o){if(s===3){var l=new i(o,o.readVarint()+o.pos);l.length&&(a[l.name]=l)}}}}),Wi=K({"node_modules/@mapbox/vector-tile/index.js"(e,t){t.exports.VectorTile=$i(),t.exports.VectorTileFeature=Yt(),t.exports.VectorTileLayer=At()}}),Zi=K({"node_modules/ieee754/index.js"(e){e.read=function(t,i,r,n,s){var a,o,l=s*8-n-1,u=(1<<l)-1,d=u>>1,x=-7,v=r?s-1:0,_=r?-1:1,F=t[i+v];for(v+=_,a=F&(1<<-x)-1,F>>=-x,x+=l;x>0;a=a*256+t[i+v],v+=_,x-=8);for(o=a&(1<<-x)-1,a>>=-x,x+=n;x>0;o=o*256+t[i+v],v+=_,x-=8);if(a===0)a=1-d;else{if(a===u)return o?NaN:(F?-1:1)*(1/0);o=o+Math.pow(2,n),a=a-d}return(F?-1:1)*o*Math.pow(2,a-n)},e.write=function(t,i,r,n,s,a){var o,l,u,d=a*8-s-1,x=(1<<d)-1,v=x>>1,_=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=n?0:a-1,S=n?1:-1,m=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(l=isNaN(i)?1:0,o=x):(o=Math.floor(Math.log(i)/Math.LN2),i*(u=Math.pow(2,-o))<1&&(o--,u*=2),o+v>=1?i+=_/u:i+=_*Math.pow(2,1-v),i*u>=2&&(o++,u/=2),o+v>=x?(l=0,o=x):o+v>=1?(l=(i*u-1)*Math.pow(2,s),o=o+v):(l=i*Math.pow(2,v-1)*Math.pow(2,s),o=0));s>=8;t[r+F]=l&255,F+=S,l/=256,s-=8);for(o=o<<s|l,d+=s;d>0;t[r+F]=o&255,F+=S,o/=256,d-=8);t[r+F-S]|=m*128}}}),Hi=K({"node_modules/pbf/index.js"(e,t){"use strict";t.exports=r;var i=Zi();function r(h){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(h)?h:new Uint8Array(h||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var n=(1<<16)*(1<<16),s=1/n,a=12,o=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");r.prototype={destroy:function(){this.buf=null},readFields:function(h,g,M){for(M=M||this.length;this.pos<M;){var P=this.readVarint(),D=P>>3,Y=this.pos;this.type=P&7,h(D,g,this),this.pos===Y&&this.skip(P)}return g},readMessage:function(h,g){return this.readFields(h,g,this.readVarint()+this.pos)},readFixed32:function(){var h=k(this.buf,this.pos);return this.pos+=4,h},readSFixed32:function(){var h=T(this.buf,this.pos);return this.pos+=4,h},readFixed64:function(){var h=k(this.buf,this.pos)+k(this.buf,this.pos+4)*n;return this.pos+=8,h},readSFixed64:function(){var h=k(this.buf,this.pos)+T(this.buf,this.pos+4)*n;return this.pos+=8,h},readFloat:function(){var h=i.read(this.buf,this.pos,!0,23,4);return this.pos+=4,h},readDouble:function(){var h=i.read(this.buf,this.pos,!0,52,8);return this.pos+=8,h},readVarint:function(h){var g=this.buf,M,P;return P=g[this.pos++],M=P&127,P<128||(P=g[this.pos++],M|=(P&127)<<7,P<128)||(P=g[this.pos++],M|=(P&127)<<14,P<128)||(P=g[this.pos++],M|=(P&127)<<21,P<128)?M:(P=g[this.pos],M|=(P&15)<<28,l(M,h,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var h=this.readVarint();return h%2===1?(h+1)/-2:h/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var h=this.readVarint()+this.pos,g=this.pos;return this.pos=h,h-g>=a&&o?X(this.buf,g,h):C(this.buf,g,h)},readBytes:function(){var h=this.readVarint()+this.pos,g=this.buf.subarray(this.pos,h);return this.pos=h,g},readPackedVarint:function(h,g){if(this.type!==r.Bytes)return h.push(this.readVarint(g));var M=u(this);for(h=h||[];this.pos<M;)h.push(this.readVarint(g));return h},readPackedSVarint:function(h){if(this.type!==r.Bytes)return h.push(this.readSVarint());var g=u(this);for(h=h||[];this.pos<g;)h.push(this.readSVarint());return h},readPackedBoolean:function(h){if(this.type!==r.Bytes)return h.push(this.readBoolean());var g=u(this);for(h=h||[];this.pos<g;)h.push(this.readBoolean());return h},readPackedFloat:function(h){if(this.type!==r.Bytes)return h.push(this.readFloat());var g=u(this);for(h=h||[];this.pos<g;)h.push(this.readFloat());return h},readPackedDouble:function(h){if(this.type!==r.Bytes)return h.push(this.readDouble());var g=u(this);for(h=h||[];this.pos<g;)h.push(this.readDouble());return h},readPackedFixed32:function(h){if(this.type!==r.Bytes)return h.push(this.readFixed32());var g=u(this);for(h=h||[];this.pos<g;)h.push(this.readFixed32());return h},readPackedSFixed32:function(h){if(this.type!==r.Bytes)return h.push(this.readSFixed32());var g=u(this);for(h=h||[];this.pos<g;)h.push(this.readSFixed32());return h},readPackedFixed64:function(h){if(this.type!==r.Bytes)return h.push(this.readFixed64());var g=u(this);for(h=h||[];this.pos<g;)h.push(this.readFixed64());return h},readPackedSFixed64:function(h){if(this.type!==r.Bytes)return h.push(this.readSFixed64());var g=u(this);for(h=h||[];this.pos<g;)h.push(this.readSFixed64());return h},skip:function(h){var g=h&7;if(g===r.Varint)for(;this.buf[this.pos++]>127;);else if(g===r.Bytes)this.pos=this.readVarint()+this.pos;else if(g===r.Fixed32)this.pos+=4;else if(g===r.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+g)},writeTag:function(h,g){this.writeVarint(h<<3|g)},realloc:function(h){for(var g=this.length||16;g<this.pos+h;)g*=2;if(g!==this.length){var M=new Uint8Array(g);M.set(this.buf),this.buf=M,this.length=g}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(h){this.realloc(4),B(this.buf,h,this.pos),this.pos+=4},writeSFixed32:function(h){this.realloc(4),B(this.buf,h,this.pos),this.pos+=4},writeFixed64:function(h){this.realloc(8),B(this.buf,h&-1,this.pos),B(this.buf,Math.floor(h*s),this.pos+4),this.pos+=8},writeSFixed64:function(h){this.realloc(8),B(this.buf,h&-1,this.pos),B(this.buf,Math.floor(h*s),this.pos+4),this.pos+=8},writeVarint:function(h){if(h=+h||0,h>268435455||h<0){x(h,this);return}this.realloc(4),this.buf[this.pos++]=h&127|(h>127?128:0),!(h<=127)&&(this.buf[this.pos++]=(h>>>=7)&127|(h>127?128:0),!(h<=127)&&(this.buf[this.pos++]=(h>>>=7)&127|(h>127?128:0),!(h<=127)&&(this.buf[this.pos++]=h>>>7&127)))},writeSVarint:function(h){this.writeVarint(h<0?-h*2-1:h*2)},writeBoolean:function(h){this.writeVarint(Boolean(h))},writeString:function(h){h=String(h),this.realloc(h.length*4),this.pos++;var g=this.pos;this.pos=V(this.buf,h,this.pos);var M=this.pos-g;M>=128&&F(g,M,this),this.pos=g-1,this.writeVarint(M),this.pos+=M},writeFloat:function(h){this.realloc(4),i.write(this.buf,h,this.pos,!0,23,4),this.pos+=4},writeDouble:function(h){this.realloc(8),i.write(this.buf,h,this.pos,!0,52,8),this.pos+=8},writeBytes:function(h){var g=h.length;this.writeVarint(g),this.realloc(g);for(var M=0;M<g;M++)this.buf[this.pos++]=h[M]},writeRawMessage:function(h,g){this.pos++;var M=this.pos;h(g,this);var P=this.pos-M;P>=128&&F(M,P,this),this.pos=M-1,this.writeVarint(P),this.pos+=P},writeMessage:function(h,g,M){this.writeTag(h,r.Bytes),this.writeRawMessage(g,M)},writePackedVarint:function(h,g){g.length&&this.writeMessage(h,S,g)},writePackedSVarint:function(h,g){g.length&&this.writeMessage(h,m,g)},writePackedBoolean:function(h,g){g.length&&this.writeMessage(h,c,g)},writePackedFloat:function(h,g){g.length&&this.writeMessage(h,y,g)},writePackedDouble:function(h,g){g.length&&this.writeMessage(h,f,g)},writePackedFixed32:function(h,g){g.length&&this.writeMessage(h,p,g)},writePackedSFixed32:function(h,g){g.length&&this.writeMessage(h,w,g)},writePackedFixed64:function(h,g){g.length&&this.writeMessage(h,b,g)},writePackedSFixed64:function(h,g){g.length&&this.writeMessage(h,z,g)},writeBytesField:function(h,g){this.writeTag(h,r.Bytes),this.writeBytes(g)},writeFixed32Field:function(h,g){this.writeTag(h,r.Fixed32),this.writeFixed32(g)},writeSFixed32Field:function(h,g){this.writeTag(h,r.Fixed32),this.writeSFixed32(g)},writeFixed64Field:function(h,g){this.writeTag(h,r.Fixed64),this.writeFixed64(g)},writeSFixed64Field:function(h,g){this.writeTag(h,r.Fixed64),this.writeSFixed64(g)},writeVarintField:function(h,g){this.writeTag(h,r.Varint),this.writeVarint(g)},writeSVarintField:function(h,g){this.writeTag(h,r.Varint),this.writeSVarint(g)},writeStringField:function(h,g){this.writeTag(h,r.Bytes),this.writeString(g)},writeFloatField:function(h,g){this.writeTag(h,r.Fixed32),this.writeFloat(g)},writeDoubleField:function(h,g){this.writeTag(h,r.Fixed64),this.writeDouble(g)},writeBooleanField:function(h,g){this.writeVarintField(h,Boolean(g))}};function l(h,g,M){var P=M.buf,D,Y;if(Y=P[M.pos++],D=(Y&112)>>4,Y<128||(Y=P[M.pos++],D|=(Y&127)<<3,Y<128)||(Y=P[M.pos++],D|=(Y&127)<<10,Y<128)||(Y=P[M.pos++],D|=(Y&127)<<17,Y<128)||(Y=P[M.pos++],D|=(Y&127)<<24,Y<128)||(Y=P[M.pos++],D|=(Y&1)<<31,Y<128))return d(h,D,g);throw new Error("Expected varint not more than 10 bytes")}function u(h){return h.type===r.Bytes?h.readVarint()+h.pos:h.pos+1}function d(h,g,M){return M?g*4294967296+(h>>>0):(g>>>0)*4294967296+(h>>>0)}function x(h,g){var M,P;if(h>=0?(M=h%4294967296|0,P=h/4294967296|0):(M=~(-h%4294967296),P=~(-h/4294967296),M^4294967295?M=M+1|0:(M=0,P=P+1|0)),h>=18446744073709552e3||h<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");g.realloc(10),v(M,P,g),_(P,g)}function v(h,g,M){M.buf[M.pos++]=h&127|128,h>>>=7,M.buf[M.pos++]=h&127|128,h>>>=7,M.buf[M.pos++]=h&127|128,h>>>=7,M.buf[M.pos++]=h&127|128,h>>>=7,M.buf[M.pos]=h&127}function _(h,g){var M=(h&7)<<4;g.buf[g.pos++]|=M|((h>>>=3)?128:0),h&&(g.buf[g.pos++]=h&127|((h>>>=7)?128:0),h&&(g.buf[g.pos++]=h&127|((h>>>=7)?128:0),h&&(g.buf[g.pos++]=h&127|((h>>>=7)?128:0),h&&(g.buf[g.pos++]=h&127|((h>>>=7)?128:0),h&&(g.buf[g.pos++]=h&127)))))}function F(h,g,M){var P=g<=16383?1:g<=2097151?2:g<=268435455?3:Math.floor(Math.log(g)/(Math.LN2*7));M.realloc(P);for(var D=M.pos-1;D>=h;D--)M.buf[D+P]=M.buf[D]}function S(h,g){for(var M=0;M<h.length;M++)g.writeVarint(h[M])}function m(h,g){for(var M=0;M<h.length;M++)g.writeSVarint(h[M])}function y(h,g){for(var M=0;M<h.length;M++)g.writeFloat(h[M])}function f(h,g){for(var M=0;M<h.length;M++)g.writeDouble(h[M])}function c(h,g){for(var M=0;M<h.length;M++)g.writeBoolean(h[M])}function p(h,g){for(var M=0;M<h.length;M++)g.writeFixed32(h[M])}function w(h,g){for(var M=0;M<h.length;M++)g.writeSFixed32(h[M])}function b(h,g){for(var M=0;M<h.length;M++)g.writeFixed64(h[M])}function z(h,g){for(var M=0;M<h.length;M++)g.writeSFixed64(h[M])}function k(h,g){return(h[g]|h[g+1]<<8|h[g+2]<<16)+h[g+3]*16777216}function B(h,g,M){h[M]=g,h[M+1]=g>>>8,h[M+2]=g>>>16,h[M+3]=g>>>24}function T(h,g){return(h[g]|h[g+1]<<8|h[g+2]<<16)+(h[g+3]<<24)}function C(h,g,M){for(var P="",D=g;D<M;){var Y=h[D],A=null,U=Y>239?4:Y>223?3:Y>191?2:1;if(D+U>M)break;var R,se,Ne;U===1?Y<128&&(A=Y):U===2?(R=h[D+1],(R&192)===128&&(A=(Y&31)<<6|R&63,A<=127&&(A=null))):U===3?(R=h[D+1],se=h[D+2],(R&192)===128&&(se&192)===128&&(A=(Y&15)<<12|(R&63)<<6|se&63,(A<=2047||A>=55296&&A<=57343)&&(A=null))):U===4&&(R=h[D+1],se=h[D+2],Ne=h[D+3],(R&192)===128&&(se&192)===128&&(Ne&192)===128&&(A=(Y&15)<<18|(R&63)<<12|(se&63)<<6|Ne&63,(A<=65535||A>=1114112)&&(A=null))),A===null?(A=65533,U=1):A>65535&&(A-=65536,P+=String.fromCharCode(A>>>10&1023|55296),A=56320|A&1023),P+=String.fromCharCode(A),D+=U}return P}function X(h,g,M){return o.decode(h.subarray(g,M))}function V(h,g,M){for(var P=0,D,Y;P<g.length;P++){if(D=g.charCodeAt(P),D>55295&&D<57344)if(Y)if(D<56320){h[M++]=239,h[M++]=191,h[M++]=189,Y=D;continue}else D=Y-55296<<10|D-56320|65536,Y=null;else{D>56319||P+1===g.length?(h[M++]=239,h[M++]=191,h[M++]=189):Y=D;continue}else Y&&(h[M++]=239,h[M++]=191,h[M++]=189,Y=null);D<128?h[M++]=D:(D<2048?h[M++]=D>>6|192:(D<65536?h[M++]=D>>12|224:(h[M++]=D>>18|240,h[M++]=D>>12&63|128),h[M++]=D>>6&63|128),h[M++]=D&63|128)}return M}}}),Ji=K({"node_modules/rbush/rbush.min.js"(e,t){(function(i,r){typeof e=="object"&&typeof t!="undefined"?t.exports=r():typeof define=="function"&&define.amd?define(r):(i=i||self).RBush=r()})(e,function(){"use strict";function i(f,c,p,w,b){(function z(k,B,T,C,X){for(;C>T;){if(C-T>600){var V=C-T+1,h=B-T+1,g=Math.log(V),M=.5*Math.exp(2*g/3),P=.5*Math.sqrt(g*M*(V-M)/V)*(h-V/2<0?-1:1),D=Math.max(T,Math.floor(B-h*M/V+P)),Y=Math.min(C,Math.floor(B+(V-h)*M/V+P));z(k,B,D,Y,X)}var A=k[B],U=T,R=C;for(r(k,T,B),X(k[C],A)>0&&r(k,T,C);U<R;){for(r(k,U,R),U++,R--;X(k[U],A)<0;)U++;for(;X(k[R],A)>0;)R--}X(k[T],A)===0?r(k,T,R):r(k,++R,C),R<=B&&(T=R+1),B<=R&&(C=R-1)}})(f,c,p||0,w||f.length-1,b||n)}function r(f,c,p){var w=f[c];f[c]=f[p],f[p]=w}function n(f,c){return f<c?-1:f>c?1:0}var s=function(f){f===void 0&&(f=9),this._maxEntries=Math.max(4,f),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(f,c,p){if(!p)return c.indexOf(f);for(var w=0;w<c.length;w++)if(p(f,c[w]))return w;return-1}function o(f,c){l(f,0,f.children.length,c,f)}function l(f,c,p,w,b){b||(b=m(null)),b.minX=1/0,b.minY=1/0,b.maxX=-1/0,b.maxY=-1/0;for(var z=c;z<p;z++){var k=f.children[z];u(b,f.leaf?w(k):k)}return b}function u(f,c){return f.minX=Math.min(f.minX,c.minX),f.minY=Math.min(f.minY,c.minY),f.maxX=Math.max(f.maxX,c.maxX),f.maxY=Math.max(f.maxY,c.maxY),f}function d(f,c){return f.minX-c.minX}function x(f,c){return f.minY-c.minY}function v(f){return(f.maxX-f.minX)*(f.maxY-f.minY)}function _(f){return f.maxX-f.minX+(f.maxY-f.minY)}function F(f,c){return f.minX<=c.minX&&f.minY<=c.minY&&c.maxX<=f.maxX&&c.maxY<=f.maxY}function S(f,c){return c.minX<=f.maxX&&c.minY<=f.maxY&&c.maxX>=f.minX&&c.maxY>=f.minY}function m(f){return{children:f,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(f,c,p,w,b){for(var z=[c,p];z.length;)if(!((p=z.pop())-(c=z.pop())<=w)){var k=c+Math.ceil((p-c)/w/2)*w;i(f,k,c,p,b),z.push(c,k,k,p)}}return s.prototype.all=function(){return this._all(this.data,[])},s.prototype.search=function(f){var c=this.data,p=[];if(!S(f,c))return p;for(var w=this.toBBox,b=[];c;){for(var z=0;z<c.children.length;z++){var k=c.children[z],B=c.leaf?w(k):k;S(f,B)&&(c.leaf?p.push(k):F(f,B)?this._all(k,p):b.push(k))}c=b.pop()}return p},s.prototype.collides=function(f){var c=this.data;if(!S(f,c))return!1;for(var p=[];c;){for(var w=0;w<c.children.length;w++){var b=c.children[w],z=c.leaf?this.toBBox(b):b;if(S(f,z)){if(c.leaf||F(f,z))return!0;p.push(b)}}c=p.pop()}return!1},s.prototype.load=function(f){if(!f||!f.length)return this;if(f.length<this._minEntries){for(var c=0;c<f.length;c++)this.insert(f[c]);return this}var p=this._build(f.slice(),0,f.length-1,0);if(this.data.children.length)if(this.data.height===p.height)this._splitRoot(this.data,p);else{if(this.data.height<p.height){var w=this.data;this.data=p,p=w}this._insert(p,this.data.height-p.height-1,!0)}else this.data=p;return this},s.prototype.insert=function(f){return f&&this._insert(f,this.data.height-1),this},s.prototype.clear=function(){return this.data=m([]),this},s.prototype.remove=function(f,c){if(!f)return this;for(var p,w,b,z=this.data,k=this.toBBox(f),B=[],T=[];z||B.length;){if(z||(z=B.pop(),w=B[B.length-1],p=T.pop(),b=!0),z.leaf){var C=a(f,z.children,c);if(C!==-1)return z.children.splice(C,1),B.push(z),this._condense(B),this}b||z.leaf||!F(z,k)?w?(p++,z=w.children[p],b=!1):z=null:(B.push(z),T.push(p),p=0,w=z,z=z.children[0])}return this},s.prototype.toBBox=function(f){return f},s.prototype.compareMinX=function(f,c){return f.minX-c.minX},s.prototype.compareMinY=function(f,c){return f.minY-c.minY},s.prototype.toJSON=function(){return this.data},s.prototype.fromJSON=function(f){return this.data=f,this},s.prototype._all=function(f,c){for(var p=[];f;)f.leaf?c.push.apply(c,f.children):p.push.apply(p,f.children),f=p.pop();return c},s.prototype._build=function(f,c,p,w){var b,z=p-c+1,k=this._maxEntries;if(z<=k)return o(b=m(f.slice(c,p+1)),this.toBBox),b;w||(w=Math.ceil(Math.log(z)/Math.log(k)),k=Math.ceil(z/Math.pow(k,w-1))),(b=m([])).leaf=!1,b.height=w;var B=Math.ceil(z/k),T=B*Math.ceil(Math.sqrt(k));y(f,c,p,T,this.compareMinX);for(var C=c;C<=p;C+=T){var X=Math.min(C+T-1,p);y(f,C,X,B,this.compareMinY);for(var V=C;V<=X;V+=B){var h=Math.min(V+B-1,X);b.children.push(this._build(f,V,h,w-1))}}return o(b,this.toBBox),b},s.prototype._chooseSubtree=function(f,c,p,w){for(;w.push(c),!c.leaf&&w.length-1!==p;){for(var b=1/0,z=1/0,k=void 0,B=0;B<c.children.length;B++){var T=c.children[B],C=v(T),X=(V=f,h=T,(Math.max(h.maxX,V.maxX)-Math.min(h.minX,V.minX))*(Math.max(h.maxY,V.maxY)-Math.min(h.minY,V.minY))-C);X<z?(z=X,b=C<b?C:b,k=T):X===z&&C<b&&(b=C,k=T)}c=k||c.children[0]}var V,h;return c},s.prototype._insert=function(f,c,p){var w=p?f:this.toBBox(f),b=[],z=this._chooseSubtree(w,this.data,c,b);for(z.children.push(f),u(z,w);c>=0&&b[c].children.length>this._maxEntries;)this._split(b,c),c--;this._adjustParentBBoxes(w,b,c)},s.prototype._split=function(f,c){var p=f[c],w=p.children.length,b=this._minEntries;this._chooseSplitAxis(p,b,w);var z=this._chooseSplitIndex(p,b,w),k=m(p.children.splice(z,p.children.length-z));k.height=p.height,k.leaf=p.leaf,o(p,this.toBBox),o(k,this.toBBox),c?f[c-1].children.push(k):this._splitRoot(p,k)},s.prototype._splitRoot=function(f,c){this.data=m([f,c]),this.data.height=f.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},s.prototype._chooseSplitIndex=function(f,c,p){for(var w,b,z,k,B,T,C,X=1/0,V=1/0,h=c;h<=p-c;h++){var g=l(f,0,h,this.toBBox),M=l(f,h,p,this.toBBox),P=(b=g,z=M,k=void 0,B=void 0,T=void 0,C=void 0,k=Math.max(b.minX,z.minX),B=Math.max(b.minY,z.minY),T=Math.min(b.maxX,z.maxX),C=Math.min(b.maxY,z.maxY),Math.max(0,T-k)*Math.max(0,C-B)),D=v(g)+v(M);P<X?(X=P,w=h,V=D<V?D:V):P===X&&D<V&&(V=D,w=h)}return w||p-c},s.prototype._chooseSplitAxis=function(f,c,p){var w=f.leaf?this.compareMinX:d,b=f.leaf?this.compareMinY:x;this._allDistMargin(f,c,p,w)<this._allDistMargin(f,c,p,b)&&f.children.sort(w)},s.prototype._allDistMargin=function(f,c,p,w){f.children.sort(w);for(var b=this.toBBox,z=l(f,0,c,b),k=l(f,p-c,p,b),B=_(z)+_(k),T=c;T<p-c;T++){var C=f.children[T];u(z,f.leaf?b(C):C),B+=_(z)}for(var X=p-c-1;X>=c;X--){var V=f.children[X];u(k,f.leaf?b(V):V),B+=_(k)}return B},s.prototype._adjustParentBBoxes=function(f,c,p){for(var w=p;w>=0;w--)u(c[w],f)},s.prototype._condense=function(f){for(var c=f.length-1,p=void 0;c>=0;c--)f[c].children.length===0?c>0?(p=f[c-1].children).splice(p.indexOf(f[c]),1):this.clear():o(f[c],this.toBBox)},s})}}),Ki=K({"src/types/unitbezier.d.ts"(){}}),Gi=K({"node_modules/tinyqueue/tinyqueue.js"(e,t){(function(i,r){typeof e=="object"&&typeof t!="undefined"?t.exports=r():typeof define=="function"&&define.amd?define(r):(i=i||self,i.TinyQueue=r())})(e,function(){"use strict";var i=function(s,a){if(s===void 0&&(s=[]),a===void 0&&(a=r),this.data=s,this.length=this.data.length,this.compare=a,this.length>0)for(var o=(this.length>>1)-1;o>=0;o--)this._down(o)};i.prototype.push=function(s){this.data.push(s),this.length++,this._up(this.length-1)},i.prototype.pop=function(){if(this.length!==0){var s=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),s}},i.prototype.peek=function(){return this.data[0]},i.prototype._up=function(s){for(var a=this,o=a.data,l=a.compare,u=o[s];s>0;){var d=s-1>>1,x=o[d];if(l(u,x)>=0)break;o[s]=x,s=d}o[s]=u},i.prototype._down=function(s){for(var a=this,o=a.data,l=a.compare,u=this.length>>1,d=o[s];s<u;){var x=(s<<1)+1,v=o[x],_=x+1;if(_<this.length&&l(o[_],v)<0&&(x=_,v=o[_]),l(v,d)>=0)break;o[s]=v,s=x}o[s]=d};function r(n,s){return n<s?-1:n>s?1:0}return i})}}),Qi=K({"node_modules/polylabel/polylabel.js"(e,t){"use strict";var i=Gi();i.default&&(i=i.default),t.exports=r,t.exports.default=r;function r(u,d,x){d=d||1;for(var v,_,F,S,m=0;m<u[0].length;m++){var y=u[0][m];(!m||y[0]<v)&&(v=y[0]),(!m||y[1]<_)&&(_=y[1]),(!m||y[0]>F)&&(F=y[0]),(!m||y[1]>S)&&(S=y[1])}var f=F-v,c=S-_,p=Math.min(f,c),w=p/2;if(p===0){var b=[v,_];return b.distance=0,b}for(var z=new i(void 0,n),k=v;k<F;k+=p)for(var B=_;B<S;B+=p)z.push(new s(k+w,B+w,w,u));var T=o(u),C=new s(v+f/2,_+c/2,0,u);C.d>T.d&&(T=C);for(var X=z.length;z.length;){var V=z.pop();V.d>T.d&&(T=V,x&&console.log("found best %d after %d probes",Math.round(1e4*V.d)/1e4,X)),!(V.max-T.d<=d)&&(w=V.h/2,z.push(new s(V.x-w,V.y-w,w,u)),z.push(new s(V.x+w,V.y-w,w,u)),z.push(new s(V.x-w,V.y+w,w,u)),z.push(new s(V.x+w,V.y+w,w,u)),X+=4)}x&&(console.log("num probes: "+X),console.log("best distance: "+T.d));var h=[T.x,T.y];return h.distance=T.d,h}function n(u,d){return d.max-u.max}function s(u,d,x,v){this.x=u,this.y=d,this.h=x,this.d=a(u,d,v),this.max=this.d+this.h*Math.SQRT2}function a(u,d,x){for(var v=!1,_=1/0,F=0;F<x.length;F++)for(var S=x[F],m=0,y=S.length,f=y-1;m<y;f=m++){var c=S[m],p=S[f];c[1]>d!=p[1]>d&&u<(p[0]-c[0])*(d-c[1])/(p[1]-c[1])+c[0]&&(v=!v),_=Math.min(_,l(u,d,c,p))}return _===0?0:(v?1:-1)*Math.sqrt(_)}function o(u){for(var d=0,x=0,v=0,_=u[0],F=0,S=_.length,m=S-1;F<S;m=F++){var y=_[F],f=_[m],c=y[0]*f[1]-f[0]*y[1];x+=(y[0]+f[0])*c,v+=(y[1]+f[1])*c,d+=c*3}return d===0?new s(_[0][0],_[0][1],0,u):new s(x/d,v/d,0,u)}function l(u,d,x,v){var _=x[0],F=x[1],S=v[0]-_,m=v[1]-F;if(S!==0||m!==0){var y=((u-_)*S+(d-F)*m)/(S*S+m*m);y>1?(_=v[0],F=v[1]):y>0&&(_+=S*y,F+=m*y)}return S=u-_,m=d-F,S*S+m*m}}}),ie=N(Q()),oe=N(Q()),be=N(Q()),er=N(Wi()),tr=N(Hi()),le=(e,t,i)=>new Promise((r,n)=>{var s=l=>{try{o(i.next(l))}catch(u){n(u)}},a=l=>{try{o(i.throw(l))}catch(u){n(u)}},o=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,a);o((i=i.apply(e,t)).next())}),It=(e,t)=>e*Math.pow(2,t),xe=(e,t)=>Math.floor(e/Math.pow(2,t)),De=(e,t)=>It(e.getUint16(t+1,!0),8)+e.getUint8(t),Et=(e,t)=>It(e.getUint32(t+2,!0),16)+e.getUint16(t,!0),ir=(e,t,i,r,n)=>{if(e!=r.getUint8(n))return e-r.getUint8(n);let s=De(r,n+1);if(t!=s)return t-s;let a=De(r,n+4);return i!=a?i-a:0},rr=(e,t,i,r)=>{let n=Rt(e,t|128,i,r);return n?{z:t,x:i,y:r,offset:n[0],length:n[1],is_dir:!0}:null},zt=(e,t,i,r)=>{let n=Rt(e,t,i,r);return n?{z:t,x:i,y:r,offset:n[0],length:n[1],is_dir:!1}:null},Rt=(e,t,i,r)=>{let n=0,s=e.byteLength/17-1;for(;n<=s;){let a=s+n>>1,o=ir(t,i,r,e,a*17);if(o>0)n=a+1;else if(o<0)s=a-1;else return[Et(e,a*17+7),e.getUint32(a*17+13,!0)]}return null},nr=e=>{if(e.byteLength<17)return null;let t=e.byteLength/17,i=Ot(e,t-1);return i.is_dir?i.z:null},sr=(e,t)=>e.is_dir&&!t.is_dir?1:!e.is_dir&&t.is_dir?-1:e.z!==t.z?e.z-t.z:e.x!==t.x?e.x-t.x:e.y-t.y,Ot=(e,t)=>{let i=e.getUint8(t*17);return{z:i&127,x:De(e,t*17+1),y:De(e,t*17+4),offset:Et(e,t*17+7),length:e.getUint32(t*17+13,!0),is_dir:i>>7===1}},Ft=e=>{let t=[];for(let i=0;i<e.byteLength/17;i++)t.push(Ot(e,i));return ar(t)},ar=e=>{e.sort(sr);let t=new ArrayBuffer(17*e.length),i=new Uint8Array(t);for(let r=0;r<e.length;r++){let n=e[r],s=n.z;n.is_dir&&(s=s|128),i[r*17]=s,i[r*17+1]=n.x&255,i[r*17+2]=n.x>>8&255,i[r*17+3]=n.x>>16&255,i[r*17+4]=n.y&255,i[r*17+5]=n.y>>8&255,i[r*17+6]=n.y>>16&255,i[r*17+7]=n.offset&255,i[r*17+8]=xe(n.offset,8)&255,i[r*17+9]=xe(n.offset,16)&255,i[r*17+10]=xe(n.offset,24)&255,i[r*17+11]=xe(n.offset,32)&255,i[r*17+12]=xe(n.offset,48)&255,i[r*17+13]=n.length&255,i[r*17+14]=n.length>>8&255,i[r*17+15]=n.length>>16&255,i[r*17+16]=n.length>>24&255}return t},or=(e,t)=>{let i=nr(e.dir);if(i){let r=t.z-i,n=Math.trunc(t.x/(1<<r)),s=Math.trunc(t.y/(1<<r));return{z:i,x:n,y:s}}return null},lr=e=>{if(e.getUint16(0,!0)!==19792)throw new Error('File header does not begin with "PM"');let i=e.getUint16(2,!0),r=e.getUint32(4,!0),n=e.getUint16(8,!0);return{version:i,json_size:r,root_entries:n}},qt=class{constructor(e,t=64){this.root=null,this.url=e,this.leaves=new Map,this.maxLeaves=t}fetchRoot(e){return le(this,null,function*(){let t=new AbortController,i=t.signal,r=yield fetch(e,{signal:i,headers:{Range:"bytes=0-511999"}}),n=r.headers.get("Content-Length");(!n||+n!=512e3)&&(console.error("Content-Length mismatch indicates byte serving not supported; aborting."),t.abort());let s=yield r.arrayBuffer(),a=lr(new DataView(s,0,10)),o=new DataView(s,10+a.json_size,17*a.root_entries);return a.version===1&&(console.warn("Sorting pmtiles v1 directory"),o=new DataView(Ft(o))),{buffer:s,header:a,dir:o}})}getRoot(){return le(this,null,function*(){return this.root?this.root:(this.root=this.fetchRoot(this.url),this.root)})}metadata(){return le(this,null,function*(){let e=yield this.getRoot(),t=new TextDecoder("utf-8"),i=JSON.parse(t.decode(new DataView(e.buffer,10,e.header.json_size)));return i.compression&&console.warn(`Archive has compression type: ${i.compression} and may not be readable directly by browsers.`),i.bounds||console.warn("Archive is missing 'bounds' in metadata, required in v2 and above."),i.minzoom||console.warn("Archive is missing 'minzoom' in metadata, required in v2 and above."),i.maxzoom||console.warn("Archive is missing 'maxzoom' in metadata, required in v2 and above."),i})}fetchLeafdir(e,t){return le(this,null,function*(){let r=yield(yield fetch(this.url,{headers:{Range:"bytes="+t.offset+"-"+(t.offset+t.length-1)}})).arrayBuffer();return e===1&&(console.warn("Sorting pmtiles v1 directory."),r=Ft(new DataView(r))),r})}getLeafdir(e,t){return le(this,null,function*(){let i=this.leaves.get(t.offset);if(i)return yield i.buffer;let r=this.fetchLeafdir(e,t);if(this.leaves.set(t.offset,{lastUsed:performance.now(),buffer:r}),this.leaves.size>this.maxLeaves){let n=1/0,s;this.leaves.forEach((a,o)=>{a.lastUsed<n&&(n=a.lastUsed,s=o)}),s&&this.leaves.delete(s)}return yield r})}getZxy(e,t,i){return le(this,null,function*(){let r=yield this.getRoot(),n=zt(r.dir,e,t,i);if(n)return n;let s=or(r,{z:e,x:t,y:i});if(s){let a=rr(r.dir,s.z,s.x,s.y);if(a){let o=yield this.getLeafdir(r.header.version,a);return zt(new DataView(o),e,t,i)}}return null})}},ne;(function(e){e[e.Point=1]="Point",e[e.Line=2]="Line",e[e.Polygon=3]="Polygon"})(ne||(ne={}));function re(e){return e.x+":"+e.y+":"+e.z}var hr=(e,t,i)=>{e.pos=t;for(var r=e.readVarint()+e.pos,n=1,s=0,a=0,o=0,l=1/0,u=-1/0,d=1/0,x=-1/0,v=[],_=[];e.pos<r;){if(s<=0){var F=e.readVarint();n=F&7,s=F>>3}if(s--,n===1||n===2)a+=e.readSVarint()*i,o+=e.readSVarint()*i,a<l&&(l=a),a>u&&(u=a),o<d&&(d=o),o>x&&(x=o),n===1&&(_.length>0&&v.push(_),_=[]),_.push(new be.default(a,o));else if(n===7)_&&_.push(_[0].clone());else throw new Error("unknown command "+n)}return _&&v.push(_),{geom:v,bbox:{minX:l,minY:d,maxX:u,maxY:x}}};function jt(e,t){let i=new er.VectorTile(new tr.default(e)),r=new Map;for(let[n,s]of Object.entries(i.layers)){let a=[],o=s;for(let l=0;l<o.length;l++){let u=hr(o.feature(l)._pbf,o.feature(l)._geometry,t/o.extent),d=0;for(let x of u.geom)d+=x.length;a.push({id:o.feature(l).id,geomType:o.feature(l).type,geom:u.geom,numVertices:d,bbox:u.bbox,props:o.feature(l).properties})}r.set(n,a)}return r}var $e=class{constructor(e,t){e.url?this.p=e:this.p=new qt(e),this.controllers=[],this.shouldCancelZooms=t}get(e,t){return Z(this,null,function*(){this.shouldCancelZooms&&(this.controllers=this.controllers.filter(s=>s[0]!=e.z?(s[1].abort(),!1):!0));let i=yield this.p.getZxy(e.z,e.x,e.y),r=new AbortController;this.controllers.push([e.z,r]);let n=r.signal;return new Promise((s,a)=>{i?fetch(this.p.url,{headers:{Range:"bytes="+i.offset+"-"+(i.offset+i.length-1)},signal:n}).then(o=>o.arrayBuffer()).then(o=>{let l=jt(o,t);s(l)}).catch(o=>{a(o)}):a(new Error(`Tile ${e.z} ${e.x} ${e.y} not found in archive`))})})}},Ut=class{constructor(e,t){this.url=e,this.controllers=[],this.shouldCancelZooms=t}get(e,t){return Z(this,null,function*(){this.shouldCancelZooms&&(this.controllers=this.controllers.filter(s=>s[0]!=e.z?(s[1].abort(),!1):!0));let i=this.url.replace("{z}",e.z.toString()).replace("{x}",e.x.toString()).replace("{y}",e.y.toString()),r=new AbortController;this.controllers.push([e.z,r]);let n=r.signal;return new Promise((s,a)=>{fetch(i,{signal:n}).then(o=>o.arrayBuffer()).then(o=>{let l=jt(o,t);s(l)}).catch(o=>{a(o)})})})}},We=6378137,kt=85.0511287798,Be=We*Math.PI,fr=e=>{let t=Math.PI/180,i=Math.max(Math.min(kt,e[0]),-kt),r=Math.sin(i*t);return new be.default(We*e[1]*t,We*Math.log((1+r)/(1-r))/2)};function St(e){return e*e}function Te(e,t){return St(e.x-t.x)+St(e.y-t.y)}function ur(e,t,i){var r=Te(t,i);if(r===0)return Te(e,t);var n=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/r;return n=Math.max(0,Math.min(1,n)),Te(e,new be.default(t.x+n*(i.x-t.x),t.y+n*(i.y-t.y)))}function Ze(e,t){for(var i=!1,r=0,n=t.length-1;r<t.length;n=r++){var s=t[r].x,a=t[r].y,o=t[n].x,l=t[n].y,u=a>e.y!=l>e.y&&e.x<(o-s)*(e.y-a)/(l-a)+s;u&&(i=!i)}return i}function Nt(e){for(var t=0,i=0;i<e.length;i++){let r=(i+1)%e.length;t+=e[i].x*e[r].y,t-=e[r].x*e[i].y}return t<0}function $t(e,t){var i=!1;for(let r of t)if(Nt(r))Ze(e,r)&&(i=!1);else{if(i)return!0;Ze(e,r)&&(i=!0)}return i}function Wt(e,t){let i=1/0;for(let r of t){let n=Math.sqrt(Te(e,r[0]));n<i&&(i=n)}return i}function Zt(e,t){let i=1/0;for(let n of t)for(var r=0;r<n.length-1;r++){let s=Math.sqrt(ur(e,n[r],n[r+1]));s<i&&(i=s)}return i}var Ht=class{constructor(e,t){this.source=e,this.cache=new Map,this.inflight=new Map,this.tileSize=t}queryFeatures(e,t,i,r){let n=fr([t,e]);var s=new be.default((n.x+Be)/(Be*2),1-(n.y+Be)/(Be*2));s.x>1&&(s.x=s.x-Math.floor(s.x));let a=s.mult(1<<i),o=Math.floor(a.x),l=Math.floor(a.y),u=re({z:i,x:o,y:l}),d=[],x=this.cache.get(u);if(x){let v=new be.default((a.x-o)*this.tileSize,(a.y-l)*this.tileSize);for(let[_,F]of x.data.entries())for(let S of F)S.geomType==1?Wt(v,S.geom)<r&&d.push({feature:S,layerName:_}):S.geomType==2?Zt(v,S.geom)<r&&d.push({feature:S,layerName:_}):$t(v,S.geom)&&d.push({feature:S,layerName:_})}return d}get(e){return Z(this,null,function*(){let t=re(e);return new Promise((i,r)=>{let n=this.cache.get(t);if(n)n.used=performance.now(),i(n.data);else{let s=this.inflight.get(t);s?s.push([i,r]):(this.inflight.set(t,[]),this.source.get(e,this.tileSize).then(a=>{this.cache.set(t,{used:performance.now(),data:a});let o=this.inflight.get(t);if(o&&o.forEach(l=>l[0](a)),this.inflight.delete(t),i(a),this.cache.size>=64){let l=1/0,u;this.cache.forEach((d,x)=>{d.used<l&&(l=d.used,u=x)}),u&&this.cache.delete(u)}}).catch(a=>{let o=this.inflight.get(t);o&&o.forEach(l=>l[1](a)),this.inflight.delete(t),r(a)}))}})})}},st=(e,t,i)=>{let r=[];for(let n of e){let s=[];for(let a of n)s.push(a.clone().mult(t).add(i));r.push(s)}return r},ge=(e,t)=>{let i=1<<t;return e<0&&(e=i+e),e>=i&&(e=e%i),e},Jt=class{constructor(e,t,i){this.tileCache=e,this.maxDataLevel=t,this.levelDiff=i}dataTilesForBounds(e,t){let i=Math.pow(2,e)/Math.pow(2,Math.ceil(e)),r=[];var n=1,s=this.tileCache.tileSize;if(e<this.levelDiff)n=1/(1<<this.levelDiff-e)*i,r.push({data_tile:{z:0,x:0,y:0},origin:new oe.default(0,0),scale:n,dim:s*n});else if(e<=this.levelDiff+this.maxDataLevel){let l=1<<this.levelDiff,u=256*i,d=Math.ceil(e)-this.levelDiff,x=Math.floor(t.minX/l/u),v=Math.floor(t.minY/l/u),_=Math.floor(t.maxX/l/u),F=Math.floor(t.maxY/l/u);for(var a=x;a<=_;a++)for(var o=v;o<=F;o++){let S=new oe.default(a*l*u,o*l*u);r.push({data_tile:{z:d,x:ge(a,d),y:ge(o,d)},origin:S,scale:i,dim:s*i})}}else{let l=1<<this.levelDiff;n=(1<<Math.ceil(e)-this.maxDataLevel-this.levelDiff)*i;let u=Math.floor(t.minX/l/256/n),d=Math.floor(t.minY/l/256/n),x=Math.floor(t.maxX/l/256/n),v=Math.floor(t.maxY/l/256/n);for(var a=u;a<=x;a++)for(var o=d;o<=v;o++){let S=new oe.default(a*l*256*n,o*l*256*n);r.push({data_tile:{z:this.maxDataLevel,x:ge(a,this.maxDataLevel),y:ge(o,this.maxDataLevel)},origin:S,scale:n,dim:s*n})}}return r}dataTileForDisplayTile(e){var t,i=1,r=this.tileCache.tileSize,n;if(e.z<this.levelDiff)t={z:0,x:0,y:0},i=1/(1<<this.levelDiff-e.z),n=new oe.default(0,0),r=r*i;else if(e.z<=this.levelDiff+this.maxDataLevel){let s=1<<this.levelDiff;t={z:e.z-this.levelDiff,x:Math.floor(e.x/s),y:Math.floor(e.y/s)},n=new oe.default(t.x*s*256,t.y*s*256)}else{i=1<<e.z-this.maxDataLevel-this.levelDiff;let s=1<<this.levelDiff;t={z:this.maxDataLevel,x:Math.floor(e.x/s/i),y:Math.floor(e.y/s/i)},n=new oe.default(t.x*s*i*256,t.y*s*i*256),r=r*i}return{data_tile:t,scale:i,origin:n,dim:r}}getBbox(e,t){return Z(this,null,function*(){let i=this.dataTilesForBounds(e,t);return(yield Promise.all(i.map(n=>this.tileCache.get(n.data_tile)))).map((n,s)=>{let a=i[s];return{data:n,z:e,data_tile:a.data_tile,scale:a.scale,dim:a.dim,origin:a.origin}})})}getDisplayTile(e){return Z(this,null,function*(){let t=this.dataTileForDisplayTile(e);return{data:yield this.tileCache.get(t.data_tile),z:e.z,data_tile:t.data_tile,scale:t.scale,origin:t.origin,dim:t.dim}})}queryFeatures(e,t,i){let r=Math.round(i),n=Math.min(r-this.levelDiff,this.maxDataLevel),s=16/(1<<r-n);return this.tileCache.queryFeatures(e,t,n,s)}},at=e=>{let t=r=>{let n=r.levelDiff===void 0?2:r.levelDiff,s=r.maxDataZoom||14,a;r.url.url?a=new $e(r.url,!0):r.url.endsWith(".pmtiles")?a=new $e(r.url,!0):a=new Ut(r.url,!0);let o=new Ht(a,256*1<<n);return new Jt(o,s,n)},i=new Map;if(e.sources)for(let[r,n]of Object.entries(e.sources))i.set(r,t(n));else i.set("",t(e));return i},dr=N(Q());function ot(e,t,i,r,n,s,a,o,l){let u=performance.now();e.save(),e.miterLimit=2;for(var d of n){if(d.minzoom&&t<d.minzoom||d.maxzoom&&t>d.maxzoom)continue;let F=i.get(d.dataSource||"");if(!!F)for(let S of F){var x=S.data.get(d.dataLayer);if(x===void 0)continue;d.symbolizer.before&&d.symbolizer.before(e,S.z);let m=S.origin,y=S.dim,f=S.scale;if(e.save(),o){e.beginPath();let c=Math.max(m.x-a.x,s.minX-a.x),p=Math.max(m.y-a.y,s.minY-a.y),w=Math.min(m.x-a.x+y,s.maxX-a.x),b=Math.min(m.y-a.y+y,s.maxY-a.y);e.rect(c,p,w-c,b-p),e.clip()}e.translate(m.x-a.x,m.y-a.y);for(var v of x){let c=v.geom,p=v.bbox;p.maxX*f+m.x<s.minX||p.minX*f+m.x>s.maxX||p.minY*f+m.y>s.maxY||p.maxY*f+m.y<s.minY||d.filter&&!d.filter(S.z,v)||(f!=1&&(c=st(c,f,new dr.default(0,0))),d.symbolizer.draw(e,c,S.z,v))}e.restore()}}if(o&&(e.beginPath(),e.rect(s.minX-a.x,s.minY-a.y,s.maxX-s.minX,s.maxY-s.minY),e.clip()),r){let F=r.searchBbox(s,1/0);for(var _ of F)if(e.save(),e.translate(_.anchor.x-a.x,_.anchor.y-a.y),_.draw(e),e.restore(),l){e.lineWidth=.5,e.strokeStyle=l,e.fillStyle=l,e.globalAlpha=1,e.fillRect(_.anchor.x-a.x-2,_.anchor.y-a.y-2,4,4);for(let S of _.bboxes)e.strokeRect(S.minX-a.x,S.minY-a.y,S.maxX-S.minX,S.maxY-S.minY)}}return e.restore(),performance.now()-u}var cr=N(Q()),pr=N(Ji()),Kt=(e,t,i)=>{let r=256,n=t/r,s=Math.floor(i.minX/r),a=Math.floor(i.minY/r),o=Math.floor(i.maxX/r),l=Math.floor(i.maxY/r),u=Math.log2(n),d=[];for(let x=s;x<=o;x++){let v=x%(1<<e);for(let _=a;_<=l;_++)d.push({display:re({z:e,x:v,y:_}),key:re({z:e-u,x:Math.floor(v/n),y:Math.floor(_/n)})})}return d},Gt=class{constructor(e,t){this.tree=new pr.default,this.current=new Map,this.dim=e,this.maxLabeledTiles=t}has(e){return this.current.has(e)}size(){return this.current.size}keys(){return this.current.keys()}searchBbox(e,t){let i=new Set;for(let r of this.tree.search(e))r.indexed_label.order<=t&&i.add(r.indexed_label);return i}searchLabel(e,t){let i=new Set;for(let r of e.bboxes)for(let n of this.tree.search(r))n.indexed_label.order<=t&&i.add(n.indexed_label);return i}bboxCollides(e,t){for(let i of this.tree.search(e))if(i.indexed_label.order<=t)return!0;return!1}labelCollides(e,t){for(let i of e.bboxes)for(let r of this.tree.search(i))if(r.indexed_label.order<=t)return!0;return!1}deduplicationCollides(e){if(!e.deduplicationKey||!e.deduplicationDistance)return!1;let t=e.deduplicationDistance,i={minX:e.anchor.x-t,minY:e.anchor.y-t,maxX:e.anchor.x+t,maxY:e.anchor.y+t};for(let r of this.tree.search(i))if(r.indexed_label.deduplicationKey===e.deduplicationKey&&r.indexed_label.anchor.dist(e.anchor)<t)return!0;return!1}makeEntry(e){this.current.get(e)&&console.log("consistency error 1");let t=new Set;this.current.set(e,t)}insert(e,t,i){let r={anchor:e.anchor,bboxes:e.bboxes,draw:e.draw,order:t,tileKey:i,deduplicationKey:e.deduplicationKey,deduplicationDistance:e.deduplicationDistance},n=this.current.get(i);if(!n){let d=new Set;this.current.set(i,d),n=d}n.add(r);var s=!1,a=!1;for(let d of e.bboxes){var o=d;o.indexed_label=r,this.tree.insert(o),d.minX<0&&(s=!0),d.maxX>this.dim&&(a=!0)}if(s||a){var l=s?this.dim:-this.dim,u=[];for(let v of e.bboxes)u.push({minX:v.minX+l,minY:v.minY,maxX:v.maxX+l,maxY:v.maxY});let d={anchor:new cr.default(e.anchor.x+l,e.anchor.y),bboxes:u,draw:e.draw,order:t,tileKey:i},x=this.current.get(i);x&&x.add(d);for(let v of u){var o=v;o.indexed_label=d,this.tree.insert(o)}}}pruneOrNoop(e){let t=e.split(":"),i,r=0,n=0;for(var s of this.current.keys()){let a=s.split(":");if(a[3]===t[3]){n++;let o=Math.sqrt(Math.pow(+a[0]-+t[0],2)+Math.pow(+a[1]-+t[1],2));o>r&&(r=o,i=s)}i&&n>this.maxLabeledTiles&&this.pruneKey(i)}}pruneKey(e){let t=this.current.get(e);if(!t)return;let i=[];for(let r of this.tree.all())t.has(r.indexed_label)&&i.push(r);i.forEach(r=>{this.tree.remove(r)}),this.current.delete(e)}removeLabel(e){let t=[];for(let r of this.tree.all())e==r.indexed_label&&t.push(r);t.forEach(r=>{this.tree.remove(r)});let i=this.current.get(e.tileKey);i&&i.delete(e)}},lt=class{constructor(e,t,i,r,n){this.index=new Gt(256*1<<e,r),this.z=e,this.scratch=t,this.labelRules=i,this.callback=n}layout(e){let t=performance.now(),i=new Set;for(let[a,o]of e)for(let l of o){let u=re(l.data_tile)+":"+a;this.index.has(u)||(this.index.makeEntry(u),i.add(u))}let r=new Set;for(let[a,o]of this.labelRules.entries()){if(o.visible==!1||o.minzoom&&this.z<o.minzoom||o.maxzoom&&this.z>o.maxzoom)continue;let l=o.dataSource||"",u=e.get(l);if(!!u)for(let d of u){let x=re(d.data_tile)+":"+l;if(!i.has(x))continue;let v=d.data.get(o.dataLayer);if(v===void 0)continue;let _=v;o.sort&&_.sort((S,m)=>o.sort?o.sort(S.props,m.props):0);let F={index:this.index,zoom:this.z,scratch:this.scratch,order:a,overzoom:this.z-d.data_tile.z};for(let S of _){if(o.filter&&!o.filter(this.z,S))continue;let m=st(S.geom,d.scale,d.origin),y=o.symbolizer.place(F,m,S);if(!!y)for(let f of y){var n=!1;if(!(f.deduplicationKey&&this.index.deduplicationCollides(f))){if(this.index.labelCollides(f,1/0)){if(!this.index.labelCollides(f,a)){let c=this.index.searchLabel(f,1/0);for(let p of c){this.index.removeLabel(p);for(let w of p.bboxes)this.findInvalidatedTiles(r,d.dim,w,x)}this.index.insert(f,a,x),n=!0}}else this.index.insert(f,a,x),n=!0;if(n)for(let c of f.bboxes)(c.maxX>d.origin.x+d.dim||c.minX<d.origin.x||c.minY<d.origin.y||c.maxY>d.origin.y+d.dim)&&this.findInvalidatedTiles(r,d.dim,c,x)}}}}}for(var s of i)this.index.pruneOrNoop(s);return r.size>0&&this.callback&&this.callback(r),performance.now()-t}findInvalidatedTiles(e,t,i,r){let n=Kt(this.z,t,i);for(let s of n)s.key!=r&&this.index.has(s.key)&&e.add(s.display)}add(e){var t=!0;for(let[i,r]of e)for(let n of r)this.index.has(re(n.data_tile)+":"+i)||(t=!1);return t?0:this.layout(e)}},He=class{constructor(e,t,i,r){this.labelers=new Map,this.scratch=e,this.labelRules=t,this.maxLabeledTiles=i,this.callback=r}add(e,t){var i=this.labelers.get(e);return i||(i=new lt(e,this.scratch,this.labelRules,this.maxLabeledTiles,this.callback),this.labelers.set(e,i)),i.add(t)}getIndex(e){let t=this.labelers.get(e);if(t)return t.index}},Pe={earth:"#FFFBF6",glacier:"#ffffff",residential:"#F4F4F8",hospital:"#FFF6F6",cemetery:"#EFF2EE",school:"#F7F6FF",industrial:"#FFF9EF",wood:"#F4F9EF",grass:"#EBF9E3",park:"#E5F9D5",water:"#B7DFF2",sand:"#ebebeb",buildings:"#F2EDE8",highwayCasing:"#FFC3C3",majorRoadCasing:"#FFB9B9",mediumRoadCasing:"#FFCE8E",minorRoadCasing:"#cccccc",highway:"#FFCEBB",majorRoad:"#FFE4B3",mediumRoad:"#FFF2C8",minorRoad:"#ffffff",boundaries:"#9e9e9e",mask:"#dddddd",countryLabel:"#aaaaaa",cityLabel:"#6C6C6C",stateLabel:"#999999",neighbourhoodLabel:"#888888",landuseLabel:"#898989",waterLabel:"#41ABDC",naturalLabel:"#4B8F14",roadsLabel:"#888888",poisLabel:"#606060"},Ve={earth:"#151515",glacier:"#1c1c1c",residential:"#252B2F",hospital:"#3E2C2C",cemetery:"#36483D",school:"#2C3440",industrial:"#33312C",wood:"#3A3E38",grass:"#4E604D",park:"#2C4034",water:"#4D5B73",sand:"#777777",buildings:"#464545",highwayCasing:"#000000",majorRoadCasing:"#1C1B1B",mediumRoadCasing:"#3E3E3E",minorRoadCasing:"#000000",highway:"#5B5B5B",majorRoad:"#595959",mediumRoad:"#4F4F4F",minorRoad:"#393939",boundaries:"#666666",mask:"#dddddd",countryLabel:"#ffffff",cityLabel:"#FFFFFF",stateLabel:"#ffffff",neighbourhoodLabel:"#FDFDFD",landuseLabel:"#DDDDDD",waterLabel:"#707E95",naturalLabel:"#4c4c4c",roadsLabel:"#C4C4C4",poisLabel:"#959393"};function ve(e,t,i){return Math.min(Math.max(e,i),t)}var ye=class extends Error{constructor(e){super(`Failed to parse color: "${e}"`)}};function mr(e){if(typeof e!="string")throw new ye(e);if(e.trim().toLowerCase()==="transparent")return[0,0,0,0];let t=e.trim();t=_r.test(e)?function(a){let o=a.toLowerCase().trim(),l=xr[function(u){let d=5381,x=u.length;for(;x;)d=33*d^u.charCodeAt(--x);return(d>>>0)%2341}(o)];if(!l)throw new ye(a);return`#${l}`}(e):e;let i=yr.exec(t);if(i){let a=Array.from(i).slice(1);return[...a.slice(0,3).map(o=>parseInt(Me(o,2),16)),parseInt(Me(a[3]||"f",2),16)/255]}let r=gr.exec(t);if(r){let a=Array.from(r).slice(1);return[...a.slice(0,3).map(o=>parseInt(o,16)),parseInt(a[3]||"ff",16)/255]}let n=wr.exec(t);if(n){let a=Array.from(n).slice(1);return[...a.slice(0,3).map(o=>parseInt(o,10)),parseFloat(a[3]||"1")]}let s=vr.exec(t);if(s){let[a,o,l,u]=Array.from(s).slice(1).map(parseFloat);if(ve(0,100,o)!==o)throw new ye(e);if(ve(0,100,l)!==l)throw new ye(e);return[...br(a,o,l),u||1]}throw new ye(e)}var Bt=e=>parseInt(e.replace(/_/g,""),36),xr="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((e,t)=>{let i=Bt(t.substring(0,3)),r=Bt(t.substring(3)).toString(16),n="";for(let s=0;s<6-r.length;s++)n+="0";return e[i]=`${n}${r}`,e},{}),Me=(e,t)=>Array.from(Array(t)).map(()=>e).join(""),yr=new RegExp(`^#${Me("([a-f0-9])",3)}([a-f0-9])?$`,"i"),gr=new RegExp(`^#${Me("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),wr=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${Me(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),vr=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,_r=/^[a-z]+$/i,Lt=e=>Math.round(255*e),br=(e,t,i)=>{let r=i/100;if(t===0)return[r,r,r].map(Lt);let n=(e%360+360)%360/60,s=(1-Math.abs(2*r-1))*(t/100),a=s*(1-Math.abs(n%2-1)),o=0,l=0,u=0;n>=0&&n<1?(o=s,l=a):n>=1&&n<2?(o=a,l=s):n>=2&&n<3?(l=s,u=a):n>=3&&n<4?(l=a,u=s):n>=4&&n<5?(o=a,u=s):n>=5&&n<6&&(o=s,u=a);let d=r-s/2;return[o+d,l+d,u+d].map(Lt)};function Tt(e){let[t,i,r,n]=mr(e).map((u,d)=>d===3?u:u/255),s=Math.max(t,i,r),a=Math.min(t,i,r),o=(s+a)/2;if(s===a)return[0,0,o,n];let l=s-a;return[60*(t===s?(i-r)/l+(i<r?6:0):i===s?(r-t)/l+2:(t-i)/l+4),o>.5?l/(2-s-a):l/(s+a),o,n]}function Mr(e,t,i,r){return`hsla(${(e%360).toFixed()}, ${ve(0,100,100*t).toFixed()}%, ${ve(0,100,100*i).toFixed()}%, ${parseFloat(ve(0,1,r).toFixed(3))})`}var J=N(Q()),zr=N(Ki()),Fr=N(Qi()),j=class{constructor(e,t){this.str=e!=null?e:t,this.per_feature=typeof this.str=="function"&&this.str.length==2}get(e,t){return typeof this.str=="function"?this.str(e,t):this.str}},E=class{constructor(e,t=1){this.value=e!=null?e:t,this.per_feature=typeof this.value=="function"&&this.value.length==2}get(e,t){return typeof this.value=="function"?this.value(e,t):this.value}},ht=class{constructor(e){var t;this.label_props=(t=e==null?void 0:e.label_props)!=null?t:["name"],this.textTransform=e==null?void 0:e.textTransform}get(e,t){let i,r;typeof this.label_props=="function"?r=this.label_props(e,t):r=this.label_props;for(let s of r)if(t.props.hasOwnProperty(s)&&typeof t.props[s]=="string"){i=t.props[s];break}let n;return typeof this.textTransform=="function"?n=this.textTransform(e,t):n=this.textTransform,i&&n==="uppercase"?i=i.toUpperCase():i&&n==="lowercase"?i=i.toLowerCase():i&&n==="capitalize"&&(i=i.toLowerCase().split(" ").map(o=>o[0].toUpperCase()+o.slice(1)).join(" ")),i}},ft=class{constructor(e){var t,i;e!=null&&e.font?this.font=e.font:(this.family=(t=e==null?void 0:e.fontFamily)!=null?t:"sans-serif",this.size=(i=e==null?void 0:e.fontSize)!=null?i:12,this.weight=e==null?void 0:e.fontWeight,this.style=e==null?void 0:e.fontStyle)}get(e,t){if(this.font)return typeof this.font=="function"?this.font(e,t):this.font;var i="";this.style&&(typeof this.style=="function"?i=this.style(e,t)+" ":i=this.style+" ");var r="";this.weight&&(typeof this.weight=="function"?r=this.weight(e,t)+" ":r=this.weight+" ");var n;typeof this.size=="function"?n=this.size(e,t):n=this.size;var s;return typeof this.family=="function"?s=this.family(e,t):s=this.family,`${i}${r}${n}px ${s}`}},kr=class{constructor(e,t=[]){this.value=e!=null?e:t,this.per_feature=typeof this.value=="function"&&this.value.length==2}get(e,t){return typeof this.value=="function"?this.value(e,t):this.value}},Ct=N(Q()),Sr=(e,t,i)=>{var r=[],n,s,a,o=0,l=0,u=0,d=0,x=0,v=0,_=0,F=0,S=0,m=0,y=0,f=0;if(e.length<2)return[];if(e.length===2)return u=Math.sqrt(Math.pow(e[1].x-e[0].x,2)+Math.pow(e[1].y-e[0].y,2)),[{length:u,beginIndex:0,beginDistance:0,endIndex:2,endDistance:u}];for(d=Math.sqrt(Math.pow(e[1].x-e[0].x,2)+Math.pow(e[1].y-e[0].y,2)),o=1,l=e.length-1;o<l;o++)n=e[o-1],s=e[o],a=e[o+1],v=s.x-n.x,_=s.y-n.y,F=a.x-s.x,S=a.y-s.y,x=Math.sqrt(F*F+S*S),u+=d,m=Math.acos((v*F+_*S)/(d*x)),(m>t||u-f>i)&&(r.push({length:u-f,beginDistance:f,beginIndex:y,endIndex:o+1,endDistance:u}),y=o,f=u),d=x;return o-y>0&&r.push({length:u-f+x,beginIndex:y,beginDistance:f,endIndex:o+1,endDistance:u+x}),r};function Br(e,t,i,r){let n,s,a=0,o=[];var l=-1/0;for(let d of e){let x=Sr(d,Math.PI/45,t);for(let v of x)if(v.length>=t+r){let _=new Ct.default(d[v.beginIndex].x,d[v.beginIndex].y),F=d[v.endIndex-1],S=new Ct.default((F.x-_.x)/v.length,(F.y-_.y)/v.length);for(var u=r;u<v.length-t;u+=i)o.push({start:_.add(S.mult(u)),end:_.add(S.mult(u+t))})}}return o}function Lr(e,t,i,r){let n=t.x-e.x,s=t.y-e.y,a=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),o=[];for(var l=0;l<i+r;l+=2*r){let u=l*1/a;o.push({x:e.x+u*n,y:e.y+u*s})}return o}function Qt(e,t){if(e.length<=t)return[e];let i=t-1,r=e.lastIndexOf(" ",i),n=e.indexOf(" ",i);if(r==-1&&n==-1)return[e];let s,a;return n==-1||r>=0&&i-r<n-i?(s=e.substring(0,r),a=e.substring(r+1,e.length)):(s=e.substring(0,n),a=e.substring(n+1,e.length)),[s,...Qt(a,t)]}var Tr="\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DB5\u4E00-\u9FEA\uF900-\uFA6D\uFA70-\uFAD9\u2000",Yn=new RegExp("^["+Tr+"]+$"),ei=5400,Je;(function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right"})(Je||(Je={}));var Ke;(function(e){e[e.N=1]="N",e[e.NE=2]="NE",e[e.E=3]="E",e[e.SE=4]="SE",e[e.S=5]="S",e[e.SW=6]="SW",e[e.W=7]="W",e[e.NW=8]="NW"})(Ke||(Ke={}));var Cr=(e,t,i)=>{let r=document.createElement("canvas"),n=r.getContext("2d");return r.width=e,r.height=t,n!==null&&i(r,n),r},O=class{constructor(e){var t;this.pattern=e.pattern,this.fill=new j(e.fill,"black"),this.opacity=new E(e.opacity,1),this.stroke=new j(e.stroke,"black"),this.width=new E(e.width,0),this.per_feature=(t=this.fill.per_feature||this.opacity.per_feature||this.stroke.per_feature||this.width.per_feature||e.per_feature)!=null?t:!1,this.do_stroke=!1}before(e,t){if(!this.per_feature){e.globalAlpha=this.opacity.get(t),e.fillStyle=this.fill.get(t),e.strokeStyle=this.stroke.get(t);let i=this.width.get(t);i>0&&(this.do_stroke=!0),e.lineWidth=i}if(this.pattern){let i=e.createPattern(this.pattern,"repeat");i&&(e.fillStyle=i)}}draw(e,t,i,r){var n=!1;if(this.per_feature){e.globalAlpha=this.opacity.get(i,r),e.fillStyle=this.fill.get(i,r);var s=this.width.get(i,r);s&&(n=!0,e.strokeStyle=this.stroke.get(i,r),e.lineWidth=s)}let a=()=>{e.fill(),(n||this.do_stroke)&&e.stroke()};var o=0;e.beginPath();for(var l of t){o+l.length>ei&&(a(),o=0,e.beginPath());for(var u=0;u<l.length;u++){let d=l[u];u==0?e.moveTo(d.x,d.y):e.lineTo(d.x,d.y)}o+=l.length}o>0&&a()}};function Dr(e,t){return i=>{let r=i-e;return r>=0&&r<t.length?t[r]:0}}function ti(e,t){let i=0;for(;t[i+1][0]<e;)i++;return i}function ii(e,t,i){return e*(i-t)+t}function ri(e,t,i,r){let n=r[t+1][0]-r[t][0],s=e-r[t][0];return n===0?0:i===1?s/n:(Math.pow(i,s)-1)/(Math.pow(i,n)-1)}function W(e,t){return i=>{if(t.length<1)return 0;if(i<=t[0][0])return t[0][1];if(i>=t[t.length-1][0])return t[t.length-1][1];let r=ti(i,t),n=ri(i,r,e,t);return ii(n,t[r][1],t[r+1][1])}}function Pr(e,t){return i=>{if(t.length<1)return 0;let r=e;for(let n=0;n<t.length;n++)i>=t[n][0]&&(r=t[n][1]);return r}}function Vr(e){return W(1,e)}function Xr(e,t,i,r,n){return s=>{if(n.length<1)return 0;let a=new zr.default(e,t,i,r),o=ti(s,n),l=a.solve(ri(s,o,1,n));return ii(l,n[o][1],n[o+1][1])}}var q=class{constructor(e){var t;this.color=new j(e.color,"black"),this.width=new E(e.width),this.opacity=new E(e.opacity),this.dash=e.dash?new kr(e.dash):null,this.dashColor=new j(e.dashColor,"black"),this.dashWidth=new E(e.dashWidth,1),this.lineCap=new j(e.lineCap,"butt"),this.lineJoin=new j(e.lineJoin,"miter"),this.skip=!1,this.per_feature=!!(((t=this.dash)==null?void 0:t.per_feature)||this.color.per_feature||this.opacity.per_feature||this.width.per_feature||this.lineCap.per_feature||this.lineJoin.per_feature||e.per_feature)}before(e,t){this.per_feature||(e.strokeStyle=this.color.get(t),e.lineWidth=this.width.get(t),e.globalAlpha=this.opacity.get(t),e.lineCap=this.lineCap.get(t),e.lineJoin=this.lineJoin.get(t))}draw(e,t,i,r){if(this.skip)return;let n=()=>{this.per_feature&&(e.globalAlpha=this.opacity.get(i,r),e.lineCap=this.lineCap.get(i,r),e.lineJoin=this.lineJoin.get(i,r)),this.dash?(e.save(),this.per_feature?(e.lineWidth=this.dashWidth.get(i,r),e.strokeStyle=this.dashColor.get(i,r),e.setLineDash(this.dash.get(i,r))):e.setLineDash(this.dash.get(i)),e.stroke(),e.restore()):(e.save(),this.per_feature&&(e.lineWidth=this.width.get(i,r),e.strokeStyle=this.color.get(i,r)),e.stroke(),e.restore())};var s=0;e.beginPath();for(var a of t){s+a.length>ei&&(n(),s=0,e.beginPath());for(var o=0;o<a.length;o++){let l=a[o];o==0?e.moveTo(l.x,l.y):e.lineTo(l.x,l.y)}s+=a.length}s>0&&n()}},Yr=class{constructor(e){this.name=e.name,this.sheet=e.sheet,this.dpr=window.devicePixelRatio}place(e,t,i){let r=t[0],n=new J.default(t[0][0].x,t[0][0].y),s=this.sheet.get(this.name),a=s.w/this.dpr,o=s.h/this.dpr,l={minX:n.x-a/2,minY:n.y-o/2,maxX:n.x+a/2,maxY:n.y+o/2};return[{anchor:n,bboxes:[l],draw:d=>{d.globalAlpha=1,d.drawImage(this.sheet.canvas,s.x,s.y,s.w,s.h,-s.w/2/this.dpr,-s.h/2/this.dpr,s.w/2,s.h/2)}}]}},ze=class{constructor(e){this.radius=new E(e.radius,3),this.fill=new j(e.fill,"black"),this.stroke=new j(e.stroke,"white"),this.width=new E(e.width,0),this.opacity=new E(e.opacity)}draw(e,t,i,r){e.globalAlpha=this.opacity.get(i,r);let n=this.radius.get(i,r),s=this.width.get(i,r);s>0&&(e.fillStyle=this.stroke.get(i,r),e.beginPath(),e.arc(t[0][0].x,t[0][0].y,n+s,0,2*Math.PI),e.fill()),e.fillStyle=this.fill.get(i,r),e.beginPath(),e.arc(t[0][0].x,t[0][0].y,n,0,2*Math.PI),e.fill()}place(e,t,i){let r=t[0],n=new J.default(t[0][0].x,t[0][0].y),s=this.radius.get(e.zoom,i),a={minX:n.x-s,minY:n.y-s,maxX:n.x+s,maxY:n.y+s};return[{anchor:n,bboxes:[a],draw:l=>{this.draw(l,[[new J.default(0,0)]],e.zoom,i)}}]}},ni=class{constructor(e){this.font=new ft(e),this.text=new ht(e),this.fill=new j(e.fill,"black"),this.background=new j(e.background,"white"),this.padding=new E(e.padding,0)}place(e,t,i){let r=this.text.get(e.zoom,i);if(!r)return;let n=this.font.get(e.zoom,i);e.scratch.font=n;let s=e.scratch.measureText(r),a=s.width,o=s.actualBoundingBoxAscent,l=s.actualBoundingBoxDescent,u=t[0],d=new J.default(t[0][0].x,t[0][0].y),x=this.padding.get(e.zoom,i),v={minX:d.x-a/2-x,minY:d.y-o-x,maxX:d.x+a/2+x,maxY:d.y+l+x};return[{anchor:d,bboxes:[v],draw:F=>{F.globalAlpha=1,F.fillStyle=this.background.get(e.zoom,i),F.fillRect(-a/2-x,-o-x,a+2*x,o+l+2*x),F.fillStyle=this.fill.get(e.zoom,i),F.font=n,F.fillText(r,-a/2,0)}}]}},Ge=class{constructor(e){this.list=e}place(e,t,i){var r=this.list[0].place(e,t,i);if(!r)return;var n=r[0];let s=n.anchor,a=n.bboxes[0],o=a.maxY-a.minY,l=[{draw:n.draw,translate:{x:0,y:0}}],u=[[new J.default(t[0][0].x,t[0][0].y+o)]];for(let x=1;x<this.list.length;x++)r=this.list[x].place(e,u,i),r&&(n=r[0],a=si(a,n.bboxes[0]),l.push({draw:n.draw,translate:{x:0,y:o}}));return[{anchor:s,bboxes:[a],draw:x=>{for(let v of l)x.save(),x.translate(v.translate.x,v.translate.y),v.draw(x),x.restore()}}]}},si=(e,t)=>({minX:Math.min(e.minX,t.minX),minY:Math.min(e.minY,t.minY),maxX:Math.max(e.maxX,t.maxX),maxY:Math.max(e.maxY,t.maxY)}),Qe=class{constructor(e){this.list=e}place(e,t,i){let r=this.list[0];if(!r)return;var n=r.place(e,t,i);if(!n)return;var s=n[0];let a=s.anchor,o=s.bboxes[0],l=[s.draw];for(let d=1;d<this.list.length;d++){if(n=this.list[d].place(e,t,i),!n)return;s=n[0],o=si(o,s.bboxes[0]),l.push(s.draw)}return[{anchor:a,bboxes:[o],draw:d=>{l.forEach(x=>x(d))}}]}},ai=class{constructor(e){this.symbolizer=e}place(e,t,i){let r=t[0][0],n=this.symbolizer.place(e,[[new J.default(0,0)]],i);if(!n||n.length==0)return;let s=n[0],a=s.bboxes[0],o=a.maxX-a.minX,l=a.maxY-a.minY,u={minX:r.x-o/2,maxX:r.x+o/2,minY:r.y-l/2,maxY:r.y+l/2};return[{anchor:r,bboxes:[u],draw:x=>{x.translate(-o/2,l/2-a.maxY),s.draw(x,{justify:2})}}]}},Ar=class{constructor(e,t){this.padding=new E(e,0),this.symbolizer=t}place(e,t,i){let r=this.symbolizer.place(e,t,i);if(!r||r.length==0)return;let n=this.padding.get(e.zoom,i);for(var s of r)for(var a of s.bboxes)a.minX-=n,a.minY-=n,a.maxX+=n,a.maxY+=n;return r}},he=class{constructor(e){this.font=new ft(e),this.text=new ht(e),this.fill=new j(e.fill,"black"),this.stroke=new j(e.stroke,"black"),this.width=new E(e.width,0),this.lineHeight=new E(e.lineHeight,1),this.letterSpacing=new E(e.letterSpacing,0),this.maxLineCodeUnits=new E(e.maxLineChars,15),this.justify=e.justify}place(e,t,i){let r=this.text.get(e.zoom,i);if(!r)return;let n=this.font.get(e.zoom,i);e.scratch.font=n;let s=this.letterSpacing.get(e.zoom,i),a=Qt(r,this.maxLineCodeUnits.get(e.zoom,i));var o="",l=0;for(let y of a)y.length>l&&(l=y.length,o=y);let u=e.scratch.measureText(o),d=u.width+s*(l-1),x=u.actualBoundingBoxAscent,v=u.actualBoundingBoxDescent,_=(x+v)*this.lineHeight.get(e.zoom,i),F=new J.default(t[0][0].x,t[0][0].y),S={minX:F.x,minY:F.y-x,maxX:F.x+d,maxY:F.y+v+(a.length-1)*_};return[{anchor:F,bboxes:[S],draw:(y,f)=>{y.globalAlpha=1,y.font=n,y.fillStyle=this.fill.get(e.zoom,i);let c=this.width.get(e.zoom,i);var p=0;for(let k of a){var w=0;if(this.justify==2||f&&f.justify==2?w=(d-y.measureText(k).width)/2:(this.justify==3||f&&f.justify==3)&&(w=d-y.measureText(k).width),c)if(y.lineWidth=c*2,y.strokeStyle=this.stroke.get(e.zoom,i),s>0){var b=w;for(var z of k)y.strokeText(z,b,p),b+=y.measureText(z).width+s}else y.strokeText(k,w,p);if(s>0){var b=w;for(var z of k)y.fillText(z,b,p),b+=y.measureText(z).width+s}else y.fillText(k,w,p);p+=_}}}]}},G=class{constructor(e){this.centered=new ai(new he(e))}place(e,t,i){return this.centered.place(e,t,i)}},oi=class{constructor(e,t){var i,r,n;this.symbolizer=e,this.offsetX=new E(t.offsetX,0),this.offsetY=new E(t.offsetY,0),this.justify=(i=t.justify)!=null?i:void 0,this.placements=(r=t.placements)!=null?r:[2,6,8,4,1,3,5,7],this.ddValues=(n=t.ddValues)!=null?n:()=>({})}place(e,t,i){if(i.geomType!==ne.Point)return;let r=t[0][0],n=this.symbolizer.place(e,[[new J.default(0,0)]],i);if(!n||n.length==0)return;let s=n[0],a=s.bboxes[0],o=this.offsetX,l=this.offsetY,u=this.justify,d=this.placements,{offsetX:x,offsetY:v,justify:_,placements:F}=this.ddValues(e.zoom,i)||{};x&&(o=new E(x,0)),v&&(l=new E(v,0)),_&&(u=_),F&&(d=F);let S=o.get(e.zoom,i),m=l.get(e.zoom,i),y=(b,z)=>({minX:b.x+z.x+a.minX,minY:b.y+z.y+a.minY,maxX:b.x+z.x+a.maxX,maxY:b.y+z.y+a.maxY});var f=new J.default(S,m),c;let p=b=>{b.translate(f.x,f.y),s.draw(b,{justify:c})},w=(b,z)=>{let k=y(b,z);if(!e.index.bboxCollides(k,e.order))return[{anchor:r,bboxes:[k],draw:p}]};for(let b of d){let z=this.computeXAxisOffset(S,a,b),k=this.computeYAxisOffset(m,a,b);return c=this.computeJustify(u,b),f=new J.default(z,k),w(r,f)}}computeXAxisOffset(e,t,i){let r=t.maxX,n=r/2;return[1,5].includes(i)?e-n:[8,7,6].includes(i)?e-r:e}computeYAxisOffset(e,t,i){let r=Math.abs(t.minY),n=t.maxY,s=(t.minY+t.maxY)/2;return[3,7].includes(i)?e-s:[8,2,1].includes(i)?e-n:[6,4,5].includes(i)?e+r:e}computeJustify(e,t){return e||([1,5].includes(t)?2:[2,3,4].includes(t)?1:3)}},we=class{constructor(e){this.symbolizer=new oi(new he(e),e)}place(e,t,i){return this.symbolizer.place(e,t,i)}},et;(function(e){e[e.Above=1]="Above",e[e.Center=2]="Center",e[e.Below=3]="Below"})(et||(et={}));var ut=class{constructor(e){var t;this.font=new ft(e),this.text=new ht(e),this.fill=new j(e.fill,"black"),this.stroke=new j(e.stroke,"black"),this.width=new E(e.width,0),this.offset=new E(e.offset,0),this.position=(t=e.position)!=null?t:1,this.maxLabelCodeUnits=new E(e.maxLabelChars,40),this.repeatDistance=new E(e.repeatDistance,250)}place(e,t,i){let r=this.text.get(e.zoom,i);if(!r||r.length>this.maxLabelCodeUnits.get(e.zoom,i))return;let n=20,s=i.bbox;if(s.maxY-s.minY<n&&s.maxX-s.minX<n)return;let a=this.font.get(e.zoom,i);e.scratch.font=a;let o=e.scratch.measureText(r),l=o.width,u=o.actualBoundingBoxAscent+o.actualBoundingBoxDescent;var d=this.repeatDistance.get(e.zoom,i);e.overzoom>4&&(d*=1<<e.overzoom-4);let x=u*2,v=Br(t,l,d,x);if(v.length==0)return;let _=[];for(let F of v){let S=F.end.x-F.start.x,m=F.end.y-F.start.y,f=Lr(F.start,F.end,l,x/2).map(p=>({minX:p.x-x/2,minY:p.y-x/2,maxX:p.x+x/2,maxY:p.y+x/2})),c=p=>{p.globalAlpha=1,p.rotate(Math.atan2(m,S)),S<0&&(p.scale(-1,-1),p.translate(-l,0));let w=0;this.position===3?w+=u:this.position===2&&(w+=u/2),p.translate(0,w-this.offset.get(e.zoom,i)),p.font=a;let b=this.width.get(e.zoom,i);b&&(p.lineWidth=b,p.strokeStyle=this.stroke.get(e.zoom,i),p.strokeText(r,0,0)),p.fillStyle=this.fill.get(e.zoom,i),p.fillText(r,0,0)};_.push({anchor:F.start,bboxes:f,draw:c,deduplicationKey:r,deduplicationDistance:d})}return _}},Ce=class{constructor(e){this.symbolizer=new he(e)}place(e,t,i){let r=i.bbox;if((r.maxY-r.minY)*(r.maxX-r.minX)<2e4)return;let s=this.symbolizer.place(e,[[new J.default(0,0)]],i);if(!s||s.length==0)return;let a=s[0],o=a.bboxes[0],l=t[0],u=(0,Fr.default)([l.map(_=>[_.x,_.y])]),d=new J.default(u[0],u[1]),x={minX:d.x-(o.maxX-o.minX)/2,minY:d.y-(o.maxY-o.minY)/2,maxX:d.x+(o.maxX-o.minX)/2,maxY:d.y+(o.maxY-o.minY)/2};return[{anchor:d,bboxes:[x],draw:_=>{_.translate(a.anchor.x-(o.maxX-o.minX)/2,a.anchor.y),a.draw(_)}}]}},li=(e,t)=>{let i=Tt(t),r=ji({},e);for(let[n,s]of Object.entries(e)){let a=Tt(s);r[n]=Mr(i[0],i[1],a[2],a[3])}return r},Xe=(e,t)=>(t&&(e=li(e,t)),[{dataLayer:"earth",symbolizer:new O({fill:e.earth})},{dataLayer:"natural",symbolizer:new O({fill:e.glacier}),filter:(i,r)=>r.props.natural=="glacier"},{dataLayer:"landuse",symbolizer:new O({fill:e.residential}),filter:(i,r)=>r.props.landuse=="residential"||r.props.place=="neighbourhood"},{dataLayer:"landuse",symbolizer:new O({fill:e.hospital}),filter:(i,r)=>r.props.amenity=="hospital"},{dataLayer:"landuse",symbolizer:new O({fill:e.cemetery}),filter:(i,r)=>r.props.landuse=="cemetery"},{dataLayer:"landuse",symbolizer:new O({fill:e.school}),filter:(i,r)=>r.props.amenity=="school"||r.props.amenity=="kindergarten"||r.props.amenity=="university"||r.props.amenity=="college"},{dataLayer:"landuse",symbolizer:new O({fill:e.industrial}),filter:(i,r)=>r.props.landuse=="industrial"},{dataLayer:"natural",symbolizer:new O({fill:e.wood}),filter:(i,r)=>r.props.natural=="wood"},{dataLayer:"landuse",symbolizer:new O({fill:e.grass}),filter:(i,r)=>r.props.landuse=="grass"},{dataLayer:"landuse",symbolizer:new O({fill:e.park}),filter:(i,r)=>r.props.leisure=="park"},{dataLayer:"water",symbolizer:new O({fill:e.water})},{dataLayer:"natural",symbolizer:new O({fill:e.sand}),filter:(i,r)=>r.props.natural=="sand"},{dataLayer:"buildings",symbolizer:new O({fill:e.buildings})},{dataLayer:"roads",symbolizer:new q({color:e.highwayCasing,width:W(1.4,[[5,1.5],[11,4],[16,9],[20,40]])}),filter:(i,r)=>r.props["pmap:kind"]=="highway"},{dataLayer:"roads",symbolizer:new q({color:e.majorRoadCasing,width:W(1.4,[[9,3],[12,4],[17,8],[20,22]])}),filter:(i,r)=>r.props["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new q({color:e.mediumRoadCasing,width:W(1.4,[[13,3],[17,6],[20,18]])}),filter:(i,r)=>r.props["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new q({color:e.minorRoadCasing,width:W(1.4,[[14,2],[17,5],[20,15]])}),filter:(i,r)=>r.props["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new q({color:e.minorRoad,width:W(1.4,[[14,1],[17,3],[20,13]])}),filter:(i,r)=>r.props["pmap:kind"]=="minor_road"},{dataLayer:"roads",symbolizer:new q({color:e.mediumRoad,width:W(1.4,[[13,2],[17,4],[20,15]])}),filter:(i,r)=>r.props["pmap:kind"]=="medium_road"},{dataLayer:"roads",symbolizer:new q({color:e.majorRoad,width:W(1.4,[[9,2],[12,3],[17,6],[20,20]])}),filter:(i,r)=>r.props["pmap:kind"]=="major_road"},{dataLayer:"roads",symbolizer:new q({color:e.highway,width:W(1.4,[[5,.5],[11,2.5],[16,7],[20,30]])}),filter:(i,r)=>r.props["pmap:kind"]=="highway"},{dataLayer:"boundaries",symbolizer:new q({color:e.boundaries,width:2,opacity:.4})},{dataLayer:"mask",symbolizer:new O({fill:e.mask})}]),Ye=(e,t,i,r)=>{t&&(e=li(e,t));var n=["name"];i&&(n=i);let s=(a,o)=>r?a instanceof we?new Ge([a,new we({fill:o,label_props:r})]):new Ge([a,new G({fill:o,label_props:r})]):a;return[{dataLayer:"places",symbolizer:s(new G({label_props:n,fill:e.countryLabel,lineHeight:1.5,font:(a,o)=>a<6?"200 14px sans-serif":"200 20px sans-serif",textTransform:"uppercase"}),e.countryLabel),filter:(a,o)=>o.props["pmap:kind"]=="country"},{dataLayer:"places",symbolizer:s(new G({label_props:n,fill:e.stateLabel,font:"300 16px sans-serif"}),e.stateLabel),filter:(a,o)=>o.props["pmap:kind"]=="state"},{id:"cities_high",dataLayer:"places",filter:(a,o)=>o.props["pmap:kind"]=="city",minzoom:7,symbolizer:s(new G({label_props:n,fill:e.cityLabel,font:(a,o)=>(o==null?void 0:o.props["pmap:rank"])===1?a>8?"600 20px sans-serif":"600 12px sans-serif":a>8?"600 16px sans-serif":"600 10px sans-serif"}),e.cityLabel),sort:(a,o)=>a["pmap:rank"]-o["pmap:rank"]},{id:"cities_low",dataLayer:"places",filter:(a,o)=>o.props["pmap:kind"]=="city",maxzoom:6,symbolizer:new Qe([new ze({radius:2,fill:e.cityLabel}),s(new we({label_props:n,fill:e.cityLabel,offsetX:2,offsetY:2,font:(a,o)=>(o==null?void 0:o.props["pmap:rank"])===1?a>8?"600 20px sans-serif":"600 12px sans-serif":a>8?"600 16px sans-serif":"600 10px sans-serif"}),e.cityLabel)]),sort:(a,o)=>a["pmap:rank"]-o["pmap:rank"]},{id:"neighbourhood",dataLayer:"places",symbolizer:s(new G({label_props:n,fill:e.neighbourhoodLabel,font:"500 10px sans-serif",textTransform:"uppercase"}),e.neighbourhoodLabel),filter:(a,o)=>o.props["pmap:kind"]=="neighbourhood"},{dataLayer:"landuse",symbolizer:s(new Ce({label_props:n,fill:e.landuseLabel,font:"300 12px sans-serif"}),e.landuseLabel)},{dataLayer:"water",symbolizer:s(new Ce({label_props:n,fill:e.waterLabel,font:"italic 600 12px sans-serif"}),e.waterLabel)},{dataLayer:"natural",symbolizer:s(new Ce({label_props:n,fill:e.naturalLabel,font:"italic 300 12px sans-serif"}),e.naturalLabel)},{dataLayer:"roads",symbolizer:s(new ut({label_props:n,fill:e.roadsLabel,font:"500 12px sans-serif"}),e.roadsLabel),minzoom:12},{dataLayer:"roads",symbolizer:new ni({label_props:["ref"],font:"600 9px sans-serif",background:e.highway,padding:2,fill:e.neighbourhoodLabel}),filter:(a,o)=>o.props["pmap:kind"]=="highway"},{dataLayer:"pois",symbolizer:new Qe([new ze({radius:2,fill:e.poisLabel}),s(new we({label_props:n,fill:e.poisLabel,offsetX:2,offsetY:2,font:"300 10px sans-serif"}),e.poisLabel)])}]},Dt=(e,t,i)=>[{dataSource:e,dataLayer:t,symbolizer:new ze({opacity:.2,fill:i,radius:4}),filter:(r,n)=>n.geomType==ne.Point},{dataSource:e,dataLayer:t,symbolizer:new q({opacity:.2,color:i,width:2}),filter:(r,n)=>n.geomType==ne.Line},{dataSource:e,dataLayer:t,symbolizer:new O({opacity:.2,fill:i,stroke:i,width:1}),filter:(r,n)=>n.geomType==ne.Polygon}],hi=(e,t)=>{var i=[];for(var[r,n]of e)for(var s of n)for(var a of s.data.keys())r===t.dataSource&&a===t.dataLayer||(i=i.concat(Dt(r,a,"steelblue")));return i=i.concat(Dt(t.dataSource||"",t.dataLayer,"red")),i},Fe=6378137,Pt=85.0511287798,H=Fe*Math.PI,fi=e=>{let t=Math.PI/180,i=Math.max(Math.min(Pt,e.y),-Pt),r=Math.sin(i*t);return new ie.default(Fe*e.x*t,Fe*Math.log((1+r)/(1-r))/2)},Ir=e=>{var t=180/Math.PI;return{lat:(2*Math.atan(Math.exp(e.y/Fe))-Math.PI/2)*t,lng:e.x*t/Fe}},Er=(e,t)=>i=>{let r=fi(i);return new ie.default((r.x+H)/(H*2),1-(r.y+H)/(H*2)).mult((1<<t)*256).sub(e)},Rr=(e,t)=>i=>{let r=new ie.default(i.x,i.y).add(e).div((1<<t)*256),n=new ie.default(r.x*(H*2)-H,(1-r.y)*(H*2)-H);return Ir(n)},tt=(e,t)=>{let i=t*(360/e);return Math.log2(i/256)},Or=class{constructor(e){let t=e.dark?Ve:Pe;this.paint_rules=e.paint_rules||Xe(t,e.shade),this.label_rules=e.label_rules||Ye(t,e.shade,e.language1,e.language2),this.backgroundColor=e.backgroundColor,this.views=at(e),this.debug=e.debug||!1,this.xray=e.xray}drawContext(e,t,i,r,n){return Z(this,null,function*(){let s=fi(r),o=new ie.default((s.x+H)/(H*2),1-(s.y+H)/(H*2)).clone().mult(Math.pow(2,n)*256).sub(new ie.default(t/2,i/2)),l={minX:o.x,minY:o.y,maxX:o.x+t,maxY:o.y+i},u=[];for(let[y,f]of this.views){let c=f.getBbox(n,l);u.push({key:y,promise:c})}let d=yield Promise.all(u.map(y=>y.promise.then(f=>({status:"fulfilled",value:f,key:y.key}),f=>({status:"rejected",value:[],reason:f,key:y.key})))),x=new Map;for(let y of d)y.status==="fulfilled"&&x.set(y.key,y.value);let v=performance.now(),_=new lt(n,e,this.label_rules,16,void 0),F=_.add(x);this.backgroundColor&&(e.save(),e.fillStyle=this.backgroundColor,e.fillRect(0,0,t,i),e.restore());let S=this.paint_rules;this.xray&&(S=hi(x,this.xray));let m=ot(e,n,x,this.xray?null:_.index,S,l,o,!0,this.debug);if(this.debug){e.save(),e.translate(-o.x,-o.y),e.strokeStyle=this.debug,e.fillStyle=this.debug,e.font="12px sans-serif";let y=0;for(let[f,c]of x){for(let p of c){e.strokeRect(p.origin.x,p.origin.y,p.dim,p.dim);let w=p.data_tile;e.fillText(f+(f?" ":"")+w.z+" "+w.x+" "+w.y,p.origin.x+4,p.origin.y+14*(1+y))}y++}e.restore()}return{elapsed:performance.now()-v,project:Er(o,n),unproject:Rr(o,n)}})}drawCanvas(e,t,i){return Z(this,arguments,function*(r,n,s,a={}){let o=window.devicePixelRatio,l=r.clientWidth,u=r.clientHeight;r.width==l*o&&r.height==u*o||(r.width=l*o,r.height=u*o),a.lang&&(r.lang=a.lang);let d=r.getContext("2d");return d.setTransform(o,0,0,o,0,0),this.drawContext(d,l,u,n,s)})}drawContextBounds(e,t,i,r,n){return Z(this,null,function*(){let s=i.x-t.x,a=new ie.default((t.y+i.y)/2,(t.x+i.x)/2);return this.drawContext(e,r,n,a,tt(s,r))})}drawCanvasBounds(e,t,i,r){return Z(this,arguments,function*(n,s,a,o,l={}){let u=a.x-s.y,d=new ie.default((s.y+a.y)/2,(s.x+a.x)/2);return this.drawCanvas(n,d,tt(u,o),l)})}},qr=N(Q()),jr=e=>new Promise((t,i)=>{setTimeout(()=>{t()},e)}),Ur=e=>e.then(t=>({status:"fulfilled",value:t}),t=>({status:"rejected",reason:t})),Nr=e=>{class t extends L.GridLayer{constructor(r){r.noWrap&&!r.bounds&&(r.bounds=[[-90,-180],[90,180]]),r.attribution==null&&(r.attribution='<a href="https://protomaps.com">Protomaps</a> \xA9 <a href="https://openstreetmap.org/copyright">OpenStreetMap</a>'),super(r);let n=r.dark?Ve:Pe;this.paint_rules=r.paint_rules||Xe(n,r.shade),this.label_rules=r.label_rules||Ye(n,r.shade,r.language1,r.language2),this.backgroundColor=r.backgroundColor,this.lastRequestedZ=void 0,this.xray=r.xray,this.tasks=r.tasks||[],this.views=at(r),this.debug=r.debug;let s=document.createElement("canvas").getContext("2d");this.scratch=s,this.onTilesInvalidated=a=>{a.forEach(o=>{this.rerenderTile(o)})},this.labelers=new He(this.scratch,this.label_rules,16,this.onTilesInvalidated),this.tile_size=256*window.devicePixelRatio,this.tileDelay=r.tileDelay||3,this.lang=r.lang,this.inspector=this.inspect(this)}setDefaultStyle(r,n,s,a){let o=r?Ve:Pe;this.paint_rules=Xe(o,n),this.label_rules=Ye(o,n,s,a)}renderTile(r,n,s,a=()=>{}){return Z(this,null,function*(){this.lastRequestedZ=r.z;let o=[];for(let[z,k]of this.views){let B=k.getDisplayTile(r);o.push({key:z,promise:B})}let l=yield Promise.all(o.map(z=>z.promise.then(k=>({status:"fulfilled",value:k,key:z.key}),k=>({status:"rejected",reason:k,key:z.key})))),u=new Map;for(let z of l)z.status==="fulfilled"&&u.set(z.key,[z.value]);if(n.key!=s||this.lastRequestedZ!==r.z||(yield Promise.all(this.tasks.map(Ur)),n.key!=s)||this.lastRequestedZ!==r.z)return;let d=this.labelers.add(r.z,u);if(n.key!=s||this.lastRequestedZ!==r.z)return;let x=this.labelers.getIndex(r.z);if(!this._map)return;let v=this._map.getCenter().wrap(),_=this._getTiledPixelBounds(v),F=this._pxBoundsToTileRange(_),S=F.getCenter(),m=r.distanceTo(S)*this.tileDelay;if(yield jr(m),n.key!=s||this.lastRequestedZ!==r.z)return;let y=16,f={minX:256*r.x-y,minY:256*r.y-y,maxX:256*(r.x+1)+y,maxY:256*(r.y+1)+y},c=new qr.default(256*r.x,256*r.y);n.width=this.tile_size,n.height=this.tile_size;let p=n.getContext("2d");p.setTransform(this.tile_size/256,0,0,this.tile_size/256,0,0),p.clearRect(0,0,256,256),this.backgroundColor&&(p.save(),p.fillStyle=this.backgroundColor,p.fillRect(0,0,256,256),p.restore());var w=0;let b=this.paint_rules;if(this.xray&&(b=hi(u,this.xray)),w=ot(p,r.z,u,this.xray?null:x,b,f,c,!1,this.debug),this.debug){p.save(),p.fillStyle=this.debug,p.font="600 12px sans-serif",p.fillText(r.z+" "+r.x+" "+r.y,4,14),p.font="12px sans-serif";let z=28;for(let[k,B]of u){let T=B[0].data_tile;p.fillText(k+(k?" ":"")+T.z+" "+T.x+" "+T.y,4,z),z+=14}p.font="600 10px sans-serif",w>8&&(p.fillText(w.toFixed()+" ms paint",4,z),z+=14),d>8&&p.fillText(d.toFixed()+" ms layout",4,z),p.strokeStyle=this.debug,p.lineWidth=.5,p.beginPath(),p.moveTo(0,0),p.lineTo(0,256),p.stroke(),p.lineWidth=.5,p.beginPath(),p.moveTo(0,0),p.lineTo(256,0),p.stroke(),p.restore()}a()})}rerenderTile(r){for(let n in this._tiles){let s=this._wrapCoords(this._keyToTileCoords(n));r===this._tileCoordsToKey(s)&&this.renderTile(s,this._tiles[n].el,r)}}clearLayout(){this.labelers=new He(this.scratch,this.label_rules,16,this.onTilesInvalidated)}rerenderTiles(){for(let r in this._tiles){let n=this._wrapCoords(this._keyToTileCoords(r)),s=this._tileCoordsToKey(n);this.renderTile(n,this._tiles[r].el,s)}}createTile(r,n){let s=L.DomUtil.create("canvas","leaflet-tile");s.lang=this.lang;let a=this._tileCoordsToKey(r);return s.key=a,this.renderTile(r,s,a,()=>{n(null,s)}),s}_removeTile(r){let n=this._tiles[r];!n||(n.el.removed=!0,n.el.key=void 0,L.DomUtil.removeClass(n.el,"leaflet-tile-loaded"),n.el.width=n.el.height=0,L.DomUtil.remove(n.el),delete this._tiles[r],this.fire("tileunload",{tile:n.el,coords:this._keyToTileCoords(r)}))}queryFeatures(r,n){let s=new Map;for(var[a,o]of this.views)s.set(a,o.queryFeatures(r,n,this._map.getZoom()));return s}inspect(r){return n=>{let s=["\u25CE","\u27CD","\u25FB"],a=r._map.wrapLatLng(n.latlng),o=r.queryFeatures(a.lng,a.lat);var l="";let u=!0;for(var[d,x]of o)for(var v of x)if(!(this.xray&&this.xray!==!0&&!((this.xray.dataSource||"")===d&&this.xray.dataLayer===v.layerName))){l=l+`<div style="margin-top:${u?0:.5}em">${s[v.feature.geomType-1]} <b>${d} ${d?"/":""} ${v.layerName}</b> ${v.feature.id||""}</div>`;for(let _ in v.feature.props)l=l+`<div style="font-size:0.9em">${_} = ${v.feature.props[_]}</div>`;u=!1}u&&(l="No features."),L.popup().setLatLng(n.latlng).setContent('<div style="max-height:400px;overflow-y:scroll;padding-right:8px">'+l+"</div>").openOn(r._map)}}addInspector(r){return r.on("click",this.inspector)}removeInspector(r){return r.off("click",this.inspector)}}return new t(e)};function $r(e){let t=0,i=0;for(let o of e)t+=o.w*o.h,i=Math.max(i,o.w);e.sort((o,l)=>l.h-o.h);let r=Math.max(Math.ceil(Math.sqrt(t/.95)),i),n=[{x:0,y:0,w:r,h:1/0}],s=0,a=0;for(let o of e)for(let l=n.length-1;l>=0;l--){let u=n[l];if(!(o.w>u.w||o.h>u.h)){if(o.x=u.x,o.y=u.y,a=Math.max(a,o.y+o.h),s=Math.max(s,o.x+o.w),o.w===u.w&&o.h===u.h){let d=n.pop();l<n.length&&(n[l]=d)}else o.h===u.h?(u.x+=o.w,u.w-=o.w):o.w===u.w?(u.y+=o.h,u.h-=o.h):(n.push({x:u.x+o.w,y:u.y,w:u.w-o.w,h:o.h}),u.y+=o.h,u.h-=o.h);break}}return{w:s,h:a,fill:t/(s*a)||0}}var Wr=(e,t,i)=>{let r=new FontFace(e,"url("+t+")",{weight:i});return document.fonts.add(r),r.load()},Vt=e=>Z(void 0,null,function*(){return new Promise((t,i)=>{let r=new Image;r.onload=()=>t(r),r.onerror=()=>i("Invalid SVG"),r.src=e})}),Zr=`
<svg width="20px" height="20px" viewBox="0 0 50 50" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <rect width="50" height="50" fill="#cccccc"/>
    <g transform="translate(5,5)">
        <path fill="none" stroke="#666666" stroke-width="7" d="m11,12a8.5,8 0 1,1 17,0q0,4-4,6t-4.5,4.5-.4,4v.2m0,3v7"/>
    </g>
</svg>
`,Hr=class{constructor(e){this.src=e,this.canvas=document.createElement("canvas"),this.mapping=new Map,this.missingBox={x:0,y:0,w:0,h:0}}load(){return Z(this,null,function*(){let e=this.src,t=window.devicePixelRatio;e.endsWith(".html")&&(e=yield(yield fetch(e)).text());let i=new window.DOMParser().parseFromString(e,"text/html"),r=Array.from(i.body.children),n=yield Vt("data:image/svg+xml;base64,"+btoa(Zr)),s=[{w:n.width*t,h:n.height*t,img:n,id:""}],a=new XMLSerializer;for(let x of r){var o=btoa(a.serializeToString(x)),l="data:image/svg+xml;base64,"+o;let v=yield Vt(l);s.push({w:v.width*t,h:v.height*t,img:v,id:x.id})}let u=$r(s);this.canvas.width=u.w,this.canvas.height=u.h;let d=this.canvas.getContext("2d");if(d)for(let x of s)x.x!==void 0&&x.y!==void 0&&(d.drawImage(x.img,x.x,x.y,x.w,x.h),x.id?this.mapping.set(x.id,{x:x.x,y:x.y,w:x.w,h:x.h}):this.missingBox={x:x.x,y:x.y,w:x.w,h:x.h});return this})}get(e){let t=this.mapping.get(e);return t||(t=this.missingBox),t}};function Le(e,t){return typeof e=="number"?e:t}function _e(e){if(e.includes("$type"))return t=>!0;if(e[0]=="==")return(t,i)=>i.props[e[1]]===e[2];if(e[0]=="!=")return(t,i)=>i.props[e[1]]!==e[2];if(e[0]=="!"){let t=_e(e[1]);return(i,r)=>!t(i,r)}else{if(e[0]==="<")return(t,i)=>Le(i.props[e[1]],1/0)<e[2];if(e[0]==="<=")return(t,i)=>Le(i.props[e[1]],1/0)<=e[2];if(e[0]===">")return(t,i)=>Le(i.props[e[1]],-1/0)>e[2];if(e[0]===">=")return(t,i)=>Le(i.props[e[1]],-1/0)>=e[2];if(e[0]==="in")return(t,i)=>e.slice(2,e.length).includes(i.props[e[1]]);if(e[0]==="!in")return(t,i)=>!e.slice(2,e.length).includes(i.props[e[1]]);if(e[0]==="has")return(t,i)=>i.props.hasOwnProperty(e[1]);if(e[0]==="!has")return(t,i)=>!i.props.hasOwnProperty(e[1]);if(e[0]==="all"){let t=e.slice(1,e.length).map(i=>_e(i));return(i,r)=>t.every(n=>n(i,r))}else if(e[0]==="any"){let t=e.slice(1,e.length).map(i=>_e(i));return(i,r)=>t.some(n=>n(i,r))}else return console.log("Unimplemented filter: ",e[0]),t=>!1}}function Ae(e){if(e.base&&e.stops)return i=>W(e.base,e.stops)(i-1);if(e[0]=="interpolate"&&e[1][0]=="exponential"&&e[2]=="zoom"){let i=e.slice(3),r=[];for(var t=0;t<i.length;t+=2)r.push([i[t],i[t+1]]);return n=>W(e[1][1],r)(n-1)}else if(e[0]=="step"&&e[1][0]=="get"){let i=e.slice(2),r=e[1][1];return(n,s)=>{let a=s==null?void 0:s.props[r];if(typeof a=="number"){if(a<i[1])return i[0];for(t=1;t<i.length;t+=2)if(a<=i[t])return i[t+1]}return i[i.length-1]}}else return console.log("Unimplemented numeric fn: ",e),i=>1}function it(e,t=0){return e?typeof e=="number"?e:(i,r)=>r?Ae(e)(i,r):t:t}function rt(e,t){let i=it(e,1),r=it(t);return(n,s)=>{let a=typeof i=="number"?i:i(n,s);return r?a+(typeof r=="number"?r:r(n,s)):a}}function nt(e,t){let i=[];for(let o of e["text-font"])t.hasOwnProperty(o)&&i.push(t[o]);i.length===0&&i.push({face:"sans-serif"});let r=e["text-size"];var n="";i.length&&i[0].weight&&(n=i[0].weight+" ");var s="";if(i.length&&i[0].style&&(s=i[0].style+" "),typeof r=="number")return o=>`${s}${n}${r}px ${i.map(l=>l.face).join(", ")}`;if(r.stops){var a=1.4;r.base&&(a=r.base);let o=Ae(r);return(l,u)=>`${s}${n}${o(l,u)}px ${i.map(d=>d.face).join(", ")}`}else if(r[0]=="step"){let o=Ae(r);return(l,u)=>`${s}${n}${o(l,u)}px ${i.map(d=>d.face).join(", ")}`}else return console.log("Can't parse font: ",e),o=>"12px sans-serif"}function Jr(e,t){let i=[],r=[],n=new Map;for(var s of e.layers){if(n.set(s.id,s),s.layout&&s.layout.visibility=="none")continue;if(s.ref){let u=n.get(s.ref);s.type=u.type,s.filter=u.filter,s.source=u.source,s["source-layer"]=u["source-layer"]}let l=s["source-layer"];var a,o=void 0;s.filter&&(o=_e(s.filter)),s.type=="fill"?i.push({dataLayer:s["source-layer"],filter:o,symbolizer:new O({fill:s.paint["fill-color"],opacity:s.paint["fill-opacity"]})}):s.type=="fill-extrusion"?i.push({dataLayer:s["source-layer"],filter:o,symbolizer:new O({fill:s.paint["fill-extrusion-color"],opacity:s.paint["fill-extrusion-opacity"]})}):s.type=="line"?s.paint["line-dasharray"]?i.push({dataLayer:s["source-layer"],filter:o,symbolizer:new q({width:rt(s.paint["line-width"],s.paint["line-gap-width"]),dash:s.paint["line-dasharray"],dashColor:s.paint["line-color"]})}):i.push({dataLayer:s["source-layer"],filter:o,symbolizer:new q({color:s.paint["line-color"],width:rt(s.paint["line-width"],s.paint["line-gap-width"])})}):s.type=="symbol"?s.layout["symbol-placement"]=="line"?r.push({dataLayer:s["source-layer"],filter:o,symbolizer:new ut({font:nt(s.layout,t),fill:s.paint["text-color"],width:s.paint["text-halo-width"],stroke:s.paint["text-halo-color"],textTransform:s.layout["text-transform"],label_props:s.layout["text-field"]?[s.layout["text-field"]]:void 0})}):r.push({dataLayer:s["source-layer"],filter:o,symbolizer:new G({font:nt(s.layout,t),fill:s.paint["text-color"],stroke:s.paint["text-halo-color"],width:s.paint["text-halo-width"],textTransform:s.layout["text-transform"],label_props:s.layout["text-field"]?[s.layout["text-field"]]:void 0})}):s.type=="circle"&&i.push({dataLayer:s["source-layer"],filter:o,symbolizer:new ze({radius:s.paint["circle-radius"],fill:s.paint["circle-color"],stroke:s.paint["circle-stroke-color"],width:s.paint["circle-stroke-width"]})})}return r.reverse(),{paint_rules:i,label_rules:r,tasks:[]}}var Si=ae(ke()),Bi=ae(di());var Sn=ae(ke()),Bn=ae(gi()),Ln=ae(Fi());function pe(e){return e.x+":"+e.y+":"+e.z}var Tn=6378137;var Fs=Tn*Math.PI;var Cn=ae(ke());var ki=(e,t,i)=>{let r=[];for(let n of e){let s=[];for(let a of n)s.push(a.clone().mult(t).add(i));r.push(s)}return r};var Dn=(e,t,i)=>{let r=256,n=t/r,s=Math.floor(i.minX/r),a=Math.floor(i.minY/r),o=Math.floor(i.maxX/r),l=Math.floor(i.maxY/r),u=Math.log2(n),d=[];for(let x=s;x<=o;x++){let v=x%(1<<e);for(let _=a;_<=l;_++)d.push({display:pe({z:e,x:v,y:_}),key:pe({z:e-u,x:Math.floor(v/n),y:Math.floor(_/n)})})}return d},gt=class{constructor(t,i){this.tree=new Bi.default,this.current=new Map,this.dim=t,this.maxLabeledTiles=i}has(t){return this.current.has(t)}size(){return this.current.size}keys(){return this.current.keys()}searchBbox(t,i){let r=new Set;for(let n of this.tree.search(t))n.indexed_label.order<=i&&r.add(n.indexed_label);return r}searchLabel(t,i){let r=new Set;for(let n of t.bboxes)for(let s of this.tree.search(n))s.indexed_label.order<=i&&r.add(s.indexed_label);return r}bboxCollides(t,i){for(let r of this.tree.search(t))if(r.indexed_label.order<=i)return!0;return!1}labelCollides(t,i){for(let r of t.bboxes)for(let n of this.tree.search(r))if(n.indexed_label.order<=i)return!0;return!1}deduplicationCollides(t){if(!t.deduplicationKey||!t.deduplicationDistance)return!1;let i=t.deduplicationDistance,r={minX:t.anchor.x-i,minY:t.anchor.y-i,maxX:t.anchor.x+i,maxY:t.anchor.y+i};for(let n of this.tree.search(r))if(n.indexed_label.deduplicationKey===t.deduplicationKey&&n.indexed_label.anchor.dist(t.anchor)<i)return!0;return!1}makeEntry(t){this.current.get(t)&&console.log("consistency error 1");let i=new Set;this.current.set(t,i)}insert(t,i,r){let n={anchor:t.anchor,bboxes:t.bboxes,draw:t.draw,order:i,tileKey:r,deduplicationKey:t.deduplicationKey,deduplicationDistance:t.deduplicationDistance},s=this.current.get(r);if(!s){let x=new Set;this.current.set(r,x),s=x}s.add(n);var a=!1,o=!1;for(let x of t.bboxes){var l=x;l.indexed_label=n,this.tree.insert(l),x.minX<0&&(a=!0),x.maxX>this.dim&&(o=!0)}if(a||o){var u=a?this.dim:-this.dim,d=[];for(let _ of t.bboxes)d.push({minX:_.minX+u,minY:_.minY,maxX:_.maxX+u,maxY:_.maxY});let x={anchor:new Si.default(t.anchor.x+u,t.anchor.y),bboxes:d,draw:t.draw,order:i,tileKey:r},v=this.current.get(r);v&&v.add(x);for(let _ of d){var l=_;l.indexed_label=x,this.tree.insert(l)}}}pruneOrNoop(t){let i=t.split(":"),r,n=0,s=0;for(var a of this.current.keys()){let o=a.split(":");if(o[3]===i[3]){s++;let l=Math.sqrt(Math.pow(+o[0]-+i[0],2)+Math.pow(+o[1]-+i[1],2));l>n&&(n=l,r=a)}r&&s>this.maxLabeledTiles&&this.pruneKey(r)}}pruneKey(t){let i=this.current.get(t);if(!i)return;let r=[];for(let n of this.tree.all())i.has(n.indexed_label)&&r.push(n);r.forEach(n=>{this.tree.remove(n)}),this.current.delete(t)}removeLabel(t){let i=[];for(let n of this.tree.all())t==n.indexed_label&&i.push(n);i.forEach(n=>{this.tree.remove(n)});let r=this.current.get(t.tileKey);r&&r.delete(t)}},wt=class{constructor(t,i,r,n,s){this.index=new gt(256*1<<t,n),this.z=t,this.scratch=i,this.labelRules=r,this.callback=s}layout(t){let i=performance.now(),r=new Set;for(let[o,l]of t)for(let u of l){let d=pe(u.data_tile)+":"+o;this.index.has(d)||(this.index.makeEntry(d),r.add(d))}let n=new Set;for(let[o,l]of this.labelRules.entries()){if(l.visible==!1||l.minzoom&&this.z<l.minzoom||l.maxzoom&&this.z>l.maxzoom)continue;let u=l.dataSource||"",d=t.get(u);if(!!d)for(let x of d){let v=pe(x.data_tile)+":"+u;if(!r.has(v))continue;let _=x.data.get(l.dataLayer);if(_===void 0)continue;let F=_;l.sort&&F.sort((m,y)=>l.sort?l.sort(m.props,y.props):0);let S={index:this.index,zoom:this.z,scratch:this.scratch,order:o,overzoom:this.z-x.data_tile.z};for(let m of F){if(l.filter&&!l.filter(this.z,m))continue;let y=ki(m.geom,x.scale,x.origin),f=l.symbolizer.place(S,y,m);if(!!f)for(let c of f){var s=!1;if(!(c.deduplicationKey&&this.index.deduplicationCollides(c))){if(this.index.labelCollides(c,1/0)){if(!this.index.labelCollides(c,o)){let p=this.index.searchLabel(c,1/0);for(let w of p){this.index.removeLabel(w);for(let b of w.bboxes)this.findInvalidatedTiles(n,x.dim,b,v)}this.index.insert(c,o,v),s=!0}}else this.index.insert(c,o,v),s=!0;if(s)for(let p of c.bboxes)(p.maxX>x.origin.x+x.dim||p.minX<x.origin.x||p.minY<x.origin.y||p.maxY>x.origin.y+x.dim)&&this.findInvalidatedTiles(n,x.dim,p,v)}}}}}for(var a of r)this.index.pruneOrNoop(a);return n.size>0&&this.callback&&this.callback(n),performance.now()-i}findInvalidatedTiles(t,i,r,n){let s=Dn(this.z,i,r);for(let a of s)a.key!=n&&this.index.has(a.key)&&t.add(a.display)}add(t){var i=!0;for(let[r,n]of t)for(let s of n)this.index.has(pe(s.data_tile)+":"+r)||(i=!1);return i?0:this.layout(t)}},qe=class{constructor(t,i,r,n){this.labelers=new Map,this.scratch=t,this.labelRules=i,this.maxLabeledTiles=r,this.callback=n}add(t,i){var r=this.labelers.get(t);return r||(r=new wt(t,this.scratch,this.labelRules,this.maxLabeledTiles,this.callback),this.labelers.set(t,r)),r.add(i)}getIndex(t){let i=this.labelers.get(t);if(i)return i.index}};var je=class{constructor(t){var i;this.label_props=(i=t==null?void 0:t.label_props)!=null?i:["name"],this.textTransform=t==null?void 0:t.textTransform}get(t,i){let r,n;typeof this.label_props=="function"?n=this.label_props(t,i):n=this.label_props;for(let a of n)if(i.props.hasOwnProperty(a)&&typeof i.props[a]=="string"){r=i.props[a];break}let s;return typeof this.textTransform=="function"?s=this.textTransform(t,i):s=this.textTransform,r&&s==="uppercase"?r=r.toUpperCase():r&&s==="lowercase"?r=r.toLowerCase():r&&s==="capitalize"&&(r=r.toLowerCase().split(" ").map(l=>l[0].toUpperCase()+l.slice(1)).join(" ")),r}};var Ue=class extends je{get(i,r){let n,s;if(typeof this.label_props=="function")n=this.label_props(i,r);else{s=this.label_props;for(let o of s)if(r.props.hasOwnProperty(o)&&typeof r.props[o]=="string"){n=r.props[o];break}}let a;return typeof this.textTransform=="function"?a=this.textTransform(i,r):a=this.textTransform,n&&a==="uppercase"?n=n.toUpperCase():n&&a==="lowercase"?n=n.toLowerCase():n&&a==="capitalize"&&(n=n.toLowerCase().split(" ").map(u=>u[0].toUpperCase()+u.slice(1)).join(" ")),n}};var me=function(e){console.error(e),console.trace()},Li=function(){let e={paint_rules:[],label_rules:[]};return e.background=function(t){e.paint_rules.push({dataLayer:"earth",symbolizer:new O({fill:t})})},e.line=function(t){t.layer||me("undefined layer for line!"),t.color||me("undefined color for line!"),t.width=t.width||1;let i={dataLayer:t.layer,symbolizer:new q({color:t.color,width:t.width,lineJoin:"round",lineCap:"round"})};t.what&&(i.filter=t.what),e.paint_rules.push(i)},e.area=function(t){t.layer||me("undefined layer for area!"),t.color||me("undefined color for area!");let i={dataLayer:t.layer,symbolizer:new O({fill:t.color})};t.what&&(i.filter=t.what),e.paint_rules.push(i)},e.name=function(t){t.layer||me("undefined layer for name!"),t.color||me("undefined color for name!");let i={dataLayer:t.layer,symbolizer:new G({fill:t.color})};t.what&&(i.filter=t.what),t.text&&typeof t.text=="function"&&i.symbolizer.centered.symbolizer instanceof he&&(i.symbolizer.centered.symbolizer.text=new Ue({label_props:t.text})),e.label_rules.push(i)},e.streetName=function(t){},e.icon=function(t){},e.namedIcon=function(t){},e.circle=function(t){},e.namedCircle=function(t){},e},Ti=function(e,t){e.paint_rules=t.paint_rules,e.label_rules=t.label_rules,e.labelers=new qe(e.scratch,e.label_rules,16,e.onTilesInvalidated),e.rerenderTiles()};function vt(e,t){let i=Li();i.background("#EEE8D5"),i.area({layer:"natural",color:"#CAEDAB",what:$.wood}),i.line({layer:"physical_line",color:"#7BAFDE",what:$.waterways}),i.area({layer:"water",color:"#7BAFDE"}),i.line({layer:"roads",color:"#F6C141"}),i.line({layer:"transit",color:"#000",what:$.railway}),i.area({layer:"buildings",color:"#D6C1DE"}),i.line({layer:"boundaries",color:"#882E72",width:3,what:$.stateBorders}),i.name({layer:"places",color:"#000",text:t.transliterator||["name"],what:$.municipality}),Ti(e,i)}return Ai(Pn);})();
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
